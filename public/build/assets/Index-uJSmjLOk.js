import{d as me,z as w,q as pe,a9 as fe,r as C,c as G,o as ge,b as h,g as i,e as a,i as l,j as _,w as f,F as J,X as ve,m as p,t as g,B as S,A as he,p as ye,n as be,l as U,Z as E,h as x,k as _e}from"./app-fEyaVeNj.js";import{u as xe}from"./platforms-C5IM1Qec.js";import{s as V}from"./index-B1y77kAB.js";import{s as z}from"./index-BAOvgU1o.js";import{s as K}from"./index-CUE77Sby.js";import{s as we}from"./index-vD2lkY0C.js";import{s as L}from"./index-Bf82pFXt.js";import{s as W,a as B,b as Be}from"./index-Cp9vA3Ae.js";import{s as T}from"./index-Cbdau87T.js";import{s as ke}from"./index-CXtElW_P.js";import{s as Ce}from"./index-DPRBmxkH.js";import{s as $e}from"./index-D1yjR3qv.js";import{s as Se}from"./index-qEfNqu90.js";import{s as Ve}from"./index-DUME89v1.js";import"./index-CniEHBiC.js";import"./index-CzS5b5Kg.js";import"./index-CaKXeVtV.js";import"./index-uZHgs35Z.js";import"./index-DHhCi5Tc.js";import"./index-WNiOysGX.js";const Fe=me("broadcasts",{state:()=>({broadcasts:[],currentBroadcast:null,recipients:[],estimatedRecipients:0,statistics:null,loading:!1,saving:!1,sending:!1,error:null,pagination:{current_page:1,per_page:20,total:0,last_page:1}}),getters:{hasBroadcasts:n=>n.broadcasts.length>0,draftCount:n=>n.broadcasts.filter(r=>r.status==="draft").length,scheduledCount:n=>n.broadcasts.filter(r=>r.status==="scheduled").length,sendingCount:n=>n.broadcasts.filter(r=>r.status==="sending").length,completedCount:n=>n.broadcasts.filter(r=>r.status==="completed").length},actions:{async fetchBroadcasts(n={}){var r,c;this.loading=!0,this.error=null;try{const s=await w.get("/api/broadcasts",{params:n});return this.broadcasts=s.data.data||[],this.pagination={current_page:s.data.current_page,per_page:s.data.per_page,total:s.data.total,last_page:s.data.last_page},s.data}catch(s){throw this.error=((c=(r=s.response)==null?void 0:r.data)==null?void 0:c.message)||"Failed to fetch broadcasts",s}finally{this.loading=!1}},async fetchBroadcast(n){var r,c;this.loading=!0,this.error=null;try{const s=await w.get(`/api/broadcasts/${n}`);return this.currentBroadcast=s.data.data,this.statistics=s.data.data.statistics,s.data.data}catch(s){throw this.error=((c=(r=s.response)==null?void 0:r.data)==null?void 0:c.message)||"Failed to fetch broadcast",s}finally{this.loading=!1}},async createBroadcast(n){var r,c;this.saving=!0,this.error=null;try{const s=await w.post("/api/broadcasts",n);return this.currentBroadcast=s.data.data,s.data.data}catch(s){throw this.error=((c=(r=s.response)==null?void 0:r.data)==null?void 0:c.message)||"Failed to create broadcast",s}finally{this.saving=!1}},async updateBroadcast(n,r){var c,s;this.saving=!0,this.error=null;try{const u=await w.put(`/api/broadcasts/${n}`,r);return this.currentBroadcast=u.data.data,u.data.data}catch(u){throw this.error=((s=(c=u.response)==null?void 0:c.data)==null?void 0:s.message)||"Failed to update broadcast",u}finally{this.saving=!1}},async deleteBroadcast(n){var r,c,s;this.saving=!0,this.error=null;try{await w.delete(`/api/broadcasts/${n}`),this.broadcasts=this.broadcasts.filter(u=>u.id!==n),((r=this.currentBroadcast)==null?void 0:r.id)===n&&(this.currentBroadcast=null)}catch(u){throw this.error=((s=(c=u.response)==null?void 0:c.data)==null?void 0:s.message)||"Failed to delete broadcast",u}finally{this.saving=!1}},async sendBroadcast(n){var r,c,s;this.sending=!0,this.error=null;try{const u=await w.post(`/api/broadcasts/${n}/send`),b=u.data.data;((r=this.currentBroadcast)==null?void 0:r.id)===n&&(this.currentBroadcast=b);const k=this.broadcasts.findIndex(F=>F.id===n);return k!==-1&&b&&(this.broadcasts[k]={...this.broadcasts[k],...b}),u.data}catch(u){throw this.error=((s=(c=u.response)==null?void 0:c.data)==null?void 0:s.message)||"Failed to send broadcast",u}finally{this.sending=!1}},async scheduleBroadcast(n,r){var c,s,u;this.saving=!0,this.error=null;try{const b=await w.post(`/api/broadcasts/${n}/schedule`,{scheduled_at:r});return((c=this.currentBroadcast)==null?void 0:c.id)===n&&(this.currentBroadcast=b.data.data),b.data}catch(b){throw this.error=((u=(s=b.response)==null?void 0:s.data)==null?void 0:u.message)||"Failed to schedule broadcast",b}finally{this.saving=!1}},async cancelBroadcast(n){var r,c,s;this.saving=!0,this.error=null;try{const u=await w.post(`/api/broadcasts/${n}/cancel`);return((r=this.currentBroadcast)==null?void 0:r.id)===n&&(this.currentBroadcast=u.data.data),u.data}catch(u){throw this.error=((s=(c=u.response)==null?void 0:c.data)==null?void 0:s.message)||"Failed to cancel broadcast",u}finally{this.saving=!1}},async fetchRecipients(n,r={}){var c,s;this.loading=!0,this.error=null;try{const u=await w.get(`/api/broadcasts/${n}/recipients`,{params:r});return this.recipients=u.data.data||[],u.data}catch(u){throw this.error=((s=(c=u.response)==null?void 0:c.data)==null?void 0:s.message)||"Failed to fetch recipients",u}finally{this.loading=!1}},async estimateRecipients(n){var r,c;this.loading=!0,this.error=null;try{const s=await w.get("/api/broadcasts/estimate",{params:n});return this.estimatedRecipients=s.data.estimated_recipients||0,this.estimatedRecipients}catch(s){throw this.error=((c=(r=s.response)==null?void 0:r.data)==null?void 0:c.message)||"Failed to estimate recipients",s}finally{this.loading=!1}},async fetchStatistics(n){var r,c;this.error=null;try{const s=await w.get(`/api/broadcasts/${n}/statistics`);return this.statistics=s.data,s.data}catch(s){throw this.error=((c=(r=s.response)==null?void 0:r.data)==null?void 0:c.message)||"Failed to fetch statistics",s}},clearError(){this.error=null},clearCurrentBroadcast(){this.currentBroadcast=null,this.recipients=[],this.statistics=null}}});var De={name:"Calendar",extends:Se,mounted:function(){console.warn("Deprecated since v4. Use DatePicker component instead.")}};const Re={class:"space-y-6"},Ue={class:"flex items-center justify-between"},Ee={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Ie={class:"p-4"},Pe={class:"text-2xl font-semibold mt-1"},Ae={class:"p-4"},Me={class:"text-2xl font-semibold mt-1"},Ne={class:"p-4"},ze={class:"text-2xl font-semibold mt-1"},Le={class:"p-4"},Te={class:"text-2xl font-semibold mt-1"},qe={class:"flex flex-wrap gap-4 items-center"},je={class:"flex-1 min-w-[200px]"},Ye={class:"w-48"},Oe={key:0,class:"flex justify-center py-12"},He={key:1,class:"text-center py-12 text-surface-500"},Qe=["onClick"],Xe={key:0,class:"flex items-center gap-2"},Ze={key:1,class:"text-surface-400"},Ge={key:0},Je={key:1,class:"text-surface-400"},Ke={key:0},We={key:1,class:"text-surface-400"},et={class:"flex gap-1"},tt={class:"space-y-4"},st={key:0,class:"text-sm text-surface-500 mt-1"},at={key:0},lt={class:"text-xs text-surface-500 mt-1"},rt={key:1},ot={class:"border-2 border-dashed border-surface-300 dark:border-surface-700 rounded-lg p-4 mb-4"},it={key:0,class:"space-y-2"},nt={class:"flex items-center justify-between mb-2"},dt={class:"text-sm font-medium"},ct={class:"grid grid-cols-2 md:grid-cols-3 gap-3"},ut=["src"],mt={class:"flex items-center gap-2 mb-2"},pt={class:"flex items-center justify-between p-3 bg-surface-50 dark:bg-surface-800 rounded-lg"},ft={class:"flex items-center gap-3"},gt={class:"text-xl font-semibold"},vt={key:0,class:"space-y-4"},ht={class:"flex items-center justify-between"},yt={class:"text-lg font-semibold"},bt={class:"grid grid-cols-3 gap-4"},_t={class:"p-3 bg-surface-50 dark:bg-surface-800 rounded-lg text-center"},xt={class:"text-2xl font-semibold"},wt={class:"p-3 bg-surface-50 dark:bg-surface-800 rounded-lg text-center"},Bt={class:"text-2xl font-semibold text-green-600"},kt={class:"p-3 bg-surface-50 dark:bg-surface-800 rounded-lg text-center"},Ct={class:"text-2xl font-semibold text-red-600"},$t={key:0},St={class:"text-sm text-surface-500 text-center"},Vt={class:"p-3 bg-surface-50 dark:bg-surface-800 rounded-lg whitespace-pre-wrap"},Ft={class:"flex gap-2"},Dt={key:0,class:"text-red-500"},Rt={key:1},Kt={__name:"Index",setup(n){const r=Fe(),c=xe(),s=pe(),u=fe(),b=C(!1),k=C(!1),F=C(!1),m=C({name:"",message:"",message_type:"text",media_urls:[],platform_connection_id:null,scheduled_at:null,filters:{},notes:""}),v=C(null),I=C(!1),P=C(0),A=C(null),D=C(null),R=C(""),ee=[{label:"All",value:null},{label:"Draft",value:"draft"},{label:"Scheduled",value:"scheduled"},{label:"Sending",value:"sending"},{label:"Completed",value:"completed"},{label:"Failed",value:"failed"},{label:"Cancelled",value:"cancelled"}],te=[{label:"Text Message",value:"text"},{label:"Image Message",value:"image"}],q=G(()=>{let o=[...r.broadcasts];if(D.value&&(o=o.filter(e=>e.status===D.value)),R.value){const e=R.value.toLowerCase();o=o.filter(d=>d.name.toLowerCase().includes(e)||d.message.toLowerCase().includes(e))}return o}),j=G(()=>c.activeConnections.map(o=>{var e;return{label:`${o.platform_account_name} (${((e=o.messaging_platform)==null?void 0:e.name)||"Unknown"})`,value:o.id}}));ge(async()=>{await Promise.all([r.fetchBroadcasts(),c.fetchConnections()])});function Y(){m.value={name:"",message:"",message_type:"text",media_urls:[],platform_connection_id:null,scheduled_at:null,filters:{},notes:""},P.value=0,b.value=!0}function se(o){v.value=o,k.value=!0}async function O(o){v.value=o,F.value=!0,await r.fetchRecipients(o.id)}async function ae(){var o,e;if(!m.value.platform_connection_id){s.add({severity:"warn",summary:"Platform Required",detail:"Please select a platform first",life:3e3});return}I.value=!0;try{const d=await r.estimateRecipients({filters:m.value.filters,platform_connection_id:m.value.platform_connection_id});P.value=d,s.add({severity:"success",summary:"Estimated",detail:`This broadcast will reach ${d} recipients`,life:3e3})}catch(d){s.add({severity:"error",summary:"Error",detail:((e=(o=d.response)==null?void 0:o.data)==null?void 0:e.message)||"Failed to estimate recipients",life:5e3})}finally{I.value=!1}}async function H(){var o,e;if(!m.value.name){s.add({severity:"warn",summary:"Name Required",detail:"Please enter a broadcast name",life:3e3});return}if(!m.value.message){s.add({severity:"warn",summary:"Message Required",detail:"Please enter a message",life:3e3});return}if(!m.value.platform_connection_id){s.add({severity:"warn",summary:"Platform Required",detail:"Please select a platform",life:3e3});return}try{const d={...m.value};m.value.scheduled_at?d.scheduled_at=new Date(m.value.scheduled_at).toISOString():delete d.scheduled_at;const t=await r.createBroadcast(d);b.value=!1,await r.fetchBroadcasts(),s.add({severity:"success",summary:"Broadcast Created",detail:`"${t.name}" has been created as a draft`,life:3e3})}catch(d){s.add({severity:"error",summary:"Error",detail:((e=(o=d.response)==null?void 0:o.data)==null?void 0:e.message)||"Failed to create broadcast",life:5e3})}}async function Q(o){u.require({message:`Are you sure you want to send "${o.name}" to ${o.total_recipients} recipients?`,header:"Send Broadcast",icon:"pi pi-exclamation-triangle",acceptClass:"p-button-primary",accept:async()=>{var e,d;try{await r.sendBroadcast(o.id),await r.fetchBroadcasts(),s.add({severity:"success",summary:"Broadcast Sent",detail:"Your broadcast is being sent",life:3e3})}catch(t){s.add({severity:"error",summary:"Error",detail:((d=(e=t.response)==null?void 0:e.data)==null?void 0:d.message)||"Failed to send broadcast",life:5e3})}}})}async function le(o){var d,t;const e=prompt("Enter date and time to send (YYYY-MM-DD HH:MM):");if(e)try{await r.scheduleBroadcast(o.id,e),await r.fetchBroadcasts(),s.add({severity:"success",summary:"Broadcast Scheduled",detail:`Broadcast will be sent at ${e}`,life:3e3})}catch(y){s.add({severity:"error",summary:"Error",detail:((t=(d=y.response)==null?void 0:d.data)==null?void 0:t.message)||"Failed to schedule broadcast",life:5e3})}}function re(o){u.require({message:`Are you sure you want to cancel "${o.name}"?`,header:"Cancel Broadcast",icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:async()=>{var e,d;try{await r.cancelBroadcast(o.id),await r.fetchBroadcasts(),s.add({severity:"success",summary:"Broadcast Cancelled",detail:"The broadcast has been cancelled",life:3e3})}catch(t){s.add({severity:"error",summary:"Error",detail:((d=(e=t.response)==null?void 0:e.data)==null?void 0:d.message)||"Failed to cancel broadcast",life:5e3})}}})}function oe(o){u.require({message:`Are you sure you want to delete "${o.name}"?`,header:"Delete Broadcast",icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:async()=>{var e,d;A.value=o.id;try{await r.deleteBroadcast(o.id),s.add({severity:"success",summary:"Broadcast Deleted",detail:"The broadcast has been deleted",life:3e3})}catch(t){s.add({severity:"error",summary:"Error",detail:((d=(e=t.response)==null?void 0:e.data)==null?void 0:d.message)||"Failed to delete broadcast",life:5e3})}finally{A.value=null}}})}function ie(o){const e=o.files;for(const d of e){const t=new FileReader;t.onload=y=>{const $=y.target.result.split(",")[1];ne($,d.name)},t.readAsDataURL(d)}}async function ne(o,e){var d;try{s.add({severity:"info",summary:"Uploading image...",detail:e,life:3e3});const t=await axios.post("/api/broadcasts/upload-image",{image:o,filename:e});t.data.url?(m.value.media_urls.push({url:t.data.url,type:"image"}),s.add({severity:"success",summary:"Image uploaded",detail:"Image added to broadcast",life:3e3})):s.add({severity:"error",summary:"Upload failed",detail:((d=t.data)==null?void 0:d.message)||"Failed to upload image",life:5e3})}catch{s.add({severity:"error",summary:"Error",detail:"Failed to upload image",life:5e3})}}function de(o){m.value.media_urls.splice(o,1)}function M(o){return{draft:"secondary",scheduled:"info",sending:"warn",completed:"success",failed:"danger",cancelled:"contrast"}[o]||"secondary"}function N(o){return o.charAt(0).toUpperCase()+o.slice(1)}function X(o){return o?new Date(o).toLocaleString():"-"}function ce(o){return{facebook:"pi pi-facebook",whatsapp:"pi pi-whatsapp",telegram:"pi pi-telegram",line:"pi pi-line"}[o]||"pi pi-send"}function ue(o){return{facebook:"#1877F2",whatsapp:"#25D366",telegram:"#0088cc",line:"#00B900"}[o]||"#6c757d"}return(o,e)=>{const d=ve("tooltip");return p(),h(J,null,[i(l(ke)),a("div",Re,[a("div",Ue,[e[17]||(e[17]=a("div",null,[a("h1",{class:"text-2xl font-semibold"},"Broadcasts"),a("p",{class:"text-surface-500 mt-1"}," Send bulk messages to your customers across messaging platforms ")],-1)),i(l(_),{label:"New Broadcast",icon:"pi pi-plus",onClick:Y})]),a("div",Ee,[i(l(V),{class:"p-0"},{content:f(()=>[a("div",Ie,[e[18]||(e[18]=a("p",{class:"text-surface-500 text-sm"},"Total Broadcasts",-1)),a("p",Pe,g(l(r).broadcasts.length),1)])]),_:1}),i(l(V),{class:"p-0"},{content:f(()=>[a("div",Ae,[e[19]||(e[19]=a("p",{class:"text-surface-500 text-sm"},"Draft",-1)),a("p",Me,g(l(r).draftCount),1)])]),_:1}),i(l(V),{class:"p-0"},{content:f(()=>[a("div",Ne,[e[20]||(e[20]=a("p",{class:"text-surface-500 text-sm"},"Scheduled",-1)),a("p",ze,g(l(r).scheduledCount),1)])]),_:1}),i(l(V),{class:"p-0"},{content:f(()=>[a("div",Le,[e[21]||(e[21]=a("p",{class:"text-surface-500 text-sm"},"Completed",-1)),a("p",Te,g(l(r).completedCount),1)])]),_:1})]),i(l(V),null,{content:f(()=>[a("div",qe,[a("div",je,[i(l(K),{modelValue:R.value,"onUpdate:modelValue":e[0]||(e[0]=t=>R.value=t),placeholder:"Search broadcasts...",class:"w-full"},null,8,["modelValue"])]),a("div",Ye,[i(l(L),{modelValue:D.value,"onUpdate:modelValue":e[1]||(e[1]=t=>D.value=t),options:ee,optionLabel:"label",optionValue:"value",placeholder:"Filter by status",class:"w-full"},null,8,["modelValue"])])])]),_:1}),i(l(V),null,{content:f(()=>[l(r).loading&&l(r).broadcasts.length===0?(p(),h("div",Oe,[i(l(he))])):q.value.length===0?(p(),h("div",He,[e[22]||(e[22]=a("i",{class:"pi pi-megaphone text-4xl mb-3 text-surface-300"},null,-1)),e[23]||(e[23]=a("p",null,"No broadcasts found",-1)),i(l(_),{label:"Create your first broadcast",link:"",onClick:Y})])):(p(),S(l(W),{key:2,value:q.value,paginator:"",rows:10,stripedRows:"",class:"p-datatable-sm"},{default:f(()=>[i(l(B),{field:"name",header:"Name",sortable:""},{body:f(({data:t})=>[a("div",{class:"font-medium cursor-pointer hover:text-primary",onClick:y=>se(t)},g(t.name),9,Qe)]),_:1}),i(l(B),{field:"platform_connection",header:"Platform"},{body:f(({data:t})=>{var y,$,Z;return[t.platform_connection?(p(),h("div",Xe,[a("i",{class:be(ce((y=t.platform_connection.messaging_platform)==null?void 0:y.slug)),style:ye({color:ue(($=t.platform_connection.messaging_platform)==null?void 0:$.slug)})},null,6),a("span",null,g((Z=t.platform_connection.messaging_platform)==null?void 0:Z.name),1)])):(p(),h("span",Ze,"Not set"))]}),_:1}),i(l(B),{field:"status",header:"Status",sortable:""},{body:f(({data:t})=>[i(l(T),{value:N(t.status),severity:M(t.status)},null,8,["value","severity"])]),_:1}),i(l(B),{field:"total_recipients",header:"Recipients",sortable:""},{body:f(({data:t})=>[U(g(t.total_recipients||0),1)]),_:1}),i(l(B),{field:"sent_count",header:"Sent",sortable:""},{body:f(({data:t})=>[t.status==="sending"||t.status==="completed"?(p(),h("span",Ge,g(t.sent_count||0),1)):(p(),h("span",Je,"-"))]),_:1}),i(l(B),{field:"scheduled_at",header:"Scheduled"},{body:f(({data:t})=>[t.scheduled_at?(p(),h("span",Ke,g(X(t.scheduled_at)),1)):(p(),h("span",We,"-"))]),_:1}),i(l(B),{header:"Actions"},{body:f(({data:t})=>{var y;return[a("div",et,[t.status==="draft"?E((p(),S(l(_),{key:0,icon:"pi pi-send",size:"small",text:"",rounded:"",onClick:$=>Q(t),loading:l(r).sending&&((y=l(r).currentBroadcast)==null?void 0:y.id)===t.id},null,8,["onClick","loading"])),[[d,"Send now"]]):x("",!0),t.status==="scheduled"?E((p(),S(l(_),{key:1,icon:"pi pi-times",size:"small",text:"",rounded:"",severity:"danger",onClick:$=>re(t)},null,8,["onClick"])),[[d,"Cancel"]]):x("",!0),E(i(l(_),{icon:"pi pi-users",size:"small",text:"",rounded:"",onClick:$=>O(t)},null,8,["onClick"]),[[d,"View recipients"]]),t.status==="draft"?E((p(),S(l(_),{key:2,icon:"pi pi-trash",size:"small",text:"",rounded:"",severity:"danger",loading:A.value===t.id,onClick:$=>oe(t)},null,8,["loading","onClick"])),[[d,"Delete"]]):x("",!0)])]}),_:1})]),_:1},8,["value"]))]),_:1})]),i(l(z),{visible:b.value,"onUpdate:visible":e[11]||(e[11]=t=>b.value=t),header:"New Broadcast",style:{width:"600px"},modal:""},{footer:f(()=>[i(l(_),{label:"Cancel",severity:"secondary",outlined:"",onClick:e[9]||(e[9]=t=>b.value=!1)}),i(l(_),{label:"Save as Draft",outlined:"",onClick:H,loading:l(r).saving},null,8,["loading"]),i(l(_),{label:"Save & Send",onClick:e[10]||(e[10]=()=>{m.value.send_now=!0,H()}),loading:l(r).saving},null,8,["loading"])]),default:f(()=>[a("div",tt,[a("div",null,[e[24]||(e[24]=a("label",{class:"block text-sm font-medium mb-1"},"Broadcast Name *",-1)),i(l(K),{modelValue:m.value.name,"onUpdate:modelValue":e[2]||(e[2]=t=>m.value.name=t),placeholder:"E.g., Summer Sale Announcement",class:"w-full"},null,8,["modelValue"])]),a("div",null,[e[26]||(e[26]=a("label",{class:"block text-sm font-medium mb-1"},"Platform *",-1)),i(l(L),{modelValue:m.value.platform_connection_id,"onUpdate:modelValue":e[3]||(e[3]=t=>m.value.platform_connection_id=t),options:j.value,optionLabel:"label",optionValue:"value",placeholder:"Select a platform connection",class:"w-full"},null,8,["modelValue","options"]),j.value.length===0?(p(),h("p",st,[...e[25]||(e[25]=[a("a",{href:"/platforms",class:"text-primary hover:underline"},"Connect a platform",-1),U(" to create broadcasts ",-1)])])):x("",!0)]),a("div",null,[e[27]||(e[27]=a("label",{class:"block text-sm font-medium mb-1"},"Message Type",-1)),i(l(L),{modelValue:m.value.message_type,"onUpdate:modelValue":e[4]||(e[4]=t=>m.value.message_type=t),options:te,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue"])]),m.value.message_type==="text"?(p(),h("div",at,[e[28]||(e[28]=a("label",{class:"block text-sm font-medium mb-1"},"Message *",-1)),i(l(we),{modelValue:m.value.message,"onUpdate:modelValue":e[5]||(e[5]=t=>m.value.message=t),rows:"5",class:"w-full",placeholder:"Enter your message here..."},null,8,["modelValue"]),a("p",lt,g(m.value.message.length)+" / 5000 characters",1)])):x("",!0),m.value.message_type==="image"?(p(),h("div",rt,[e[31]||(e[31]=a("label",{class:"block text-sm font-medium mb-1"},"Images *",-1)),a("div",ot,[i(l(Ve),{mode:"basic",accept:"image/*",multiple:!0,maxFileSize:1e7,onSelect:ie,chooseLabel:"Upload Images",class:"w-full"}),e[29]||(e[29]=a("p",{class:"text-xs text-surface-500 mt-1"},"Upload up to 5 images (max 10MB each)",-1))]),m.value.media_urls.length>0?(p(),h("div",it,[a("div",nt,[a("h4",dt,"Uploaded Images ("+g(m.value.media_urls.length)+")",1),i(l(_),{icon:"pi pi-times",size:"small",text:"",rounded:"",severity:"secondary",onClick:e[6]||(e[6]=t=>m.value.media_urls=[])},{default:f(()=>[...e[30]||(e[30]=[U(" Clear All ",-1)])]),_:1})]),a("div",ct,[(p(!0),h(J,null,_e(m.value.media_urls,(t,y)=>(p(),h("div",{key:y,class:"relative group"},[a("img",{src:t.url,class:"w-full h-32 object-cover rounded-lg border border-surface-200 dark:border-surface-700",alt:"Uploaded image"},null,8,ut),i(l(_),{icon:"pi pi-times",size:"small",text:"",rounded:"",severity:"danger",class:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",onClick:$=>de(y)},null,8,["onClick"])]))),128))])])):x("",!0)])):x("",!0),a("div",null,[a("div",mt,[i(l(Be),{modelValue:m.value.schedule_later,"onUpdate:modelValue":e[7]||(e[7]=t=>m.value.schedule_later=t),binary:""},null,8,["modelValue"]),e[32]||(e[32]=a("label",{class:"text-sm font-medium"},"Schedule for later",-1))]),m.value.schedule_later?(p(),S(l(De),{key:0,modelValue:m.value.scheduled_at,"onUpdate:modelValue":e[8]||(e[8]=t=>m.value.scheduled_at=t),showTime:"",hourFormat:"12",placeholder:"Select date and time",class:"w-full"},null,8,["modelValue"])):x("",!0)]),i(l($e)),a("div",pt,[e[33]||(e[33]=a("div",null,[a("p",{class:"font-medium"},"Estimated Recipients"),a("p",{class:"text-sm text-surface-500"},"Based on selected platform and filters")],-1)),a("div",ft,[a("span",gt,g(P.value),1),i(l(_),{label:"Estimate",size:"small",outlined:"",loading:I.value,onClick:ae},null,8,["loading"])])])])]),_:1},8,["visible"]),i(l(z),{visible:k.value,"onUpdate:visible":e[15]||(e[15]=t=>k.value=t),header:"Broadcast Details",style:{width:"700px"},modal:""},{default:f(()=>{var t,y;return[v.value?(p(),h("div",vt,[a("div",ht,[a("h3",yt,g(v.value.name),1),i(l(T),{value:N(v.value.status),severity:M(v.value.status)},null,8,["value","severity"])]),a("div",bt,[a("div",_t,[a("p",xt,g(v.value.total_recipients||0),1),e[34]||(e[34]=a("p",{class:"text-sm text-surface-500"},"Total Recipients",-1))]),a("div",wt,[a("p",Bt,g(v.value.sent_count||0),1),e[35]||(e[35]=a("p",{class:"text-sm text-surface-500"},"Sent",-1))]),a("div",kt,[a("p",Ct,g(v.value.failed_count||0),1),e[36]||(e[36]=a("p",{class:"text-sm text-surface-500"},"Failed",-1))])]),v.value.status==="sending"||v.value.status==="completed"?(p(),h("div",$t,[i(l(Ce),{value:((t=v.value.statistics)==null?void 0:t.completion_percentage)||0,class:"mb-2"},null,8,["value"]),a("p",St,g(((y=v.value.statistics)==null?void 0:y.completion_percentage)||0)+"% complete ",1)])):x("",!0),a("div",null,[e[37]||(e[37]=a("h4",{class:"font-medium mb-2"},"Message",-1)),a("div",Vt,g(v.value.message),1)]),a("div",Ft,[v.value.status==="draft"?(p(),S(l(_),{key:0,label:"Send Now",icon:"pi pi-send",onClick:e[12]||(e[12]=()=>{k.value=!1,Q(v.value)})})):x("",!0),v.value.status==="draft"?(p(),S(l(_),{key:1,label:"Schedule",icon:"pi pi-calendar",outlined:"",onClick:e[13]||(e[13]=()=>{k.value=!1,le(v.value)})})):x("",!0),i(l(_),{label:"View Recipients",icon:"pi pi-users",outlined:"",onClick:e[14]||(e[14]=()=>{k.value=!1,O(v.value)})})])])):x("",!0)]}),_:1},8,["visible"]),i(l(z),{visible:F.value,"onUpdate:visible":e[16]||(e[16]=t=>F.value=t),header:"Broadcast Recipients",style:{width:"800px"},modal:""},{default:f(()=>[i(l(W),{value:l(r).recipients,loading:l(r).loading,paginator:"",rows:20,class:"p-datatable-sm"},{default:f(()=>[i(l(B),{field:"customer.name",header:"Customer"}),i(l(B),{field:"status",header:"Status"},{body:f(({data:t})=>[i(l(T),{value:N(t.status),severity:M(t.status)},null,8,["value","severity"])]),_:1}),i(l(B),{field:"sent_at",header:"Sent At"},{body:f(({data:t})=>[U(g(t.sent_at?X(t.sent_at):"-"),1)]),_:1}),i(l(B),{field:"error_message",header:"Error"},{body:f(({data:t})=>[t.error_message?(p(),h("span",Dt,g(t.error_message),1)):(p(),h("span",Rt,"-"))]),_:1})]),_:1},8,["value","loading"])]),_:1},8,["visible"])],64)}}};export{Kt as default};
