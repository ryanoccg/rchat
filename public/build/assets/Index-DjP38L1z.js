import{d as Ge,H as S,D as We,a6 as He,J as Je,j as w,a7 as Qe,K as Xe,L as Ye,T as et,Q as X,a8 as tt,x as me,X as he,B as _,m as d,w as v,b as p,h as C,G as P,g as u,$ as st,Z as $,a0 as R,F as E,e as r,n as te,t as b,_ as at,q as nt,a9 as rt,r as k,c as pe,o as ot,a1 as lt,i as n,k as F,v as it,I as fe,y as ut,l as dt,a5 as W}from"./app-COZ50StM.js";import{s as ct,a as I}from"./index-BotssOam.js";import{u as mt,b as pt,s as ve}from"./index-lWUrvOYP.js";import{s as D}from"./index-CXogGqNS.js";import{s as Y}from"./index-D6-_aDNt.js";import{s as j}from"./index-B0AQL8E4.js";import{s as H}from"./index-D8SOZXLq.js";import{s as N}from"./index-BluEwxCg.js";import{s as z}from"./index-DrT0AH4f.js";import{s as ft}from"./index-faQNcuJe.js";import{s as J}from"./index-8DNwRh8N.js";import"./index-C0zA7P76.js";import"./index-Brg-r7B6.js";import"./index-CbPeJRyp.js";import"./index-DZelkFbS.js";const vt=Ge("customers",{state:()=>({customers:[],currentCustomer:null,customerConversations:[],allTags:[],stats:null,pagination:{currentPage:1,lastPage:1,perPage:15,total:0},filters:{search:"",platform:null,tag:null,dateFrom:null,dateTo:null,sortBy:"created_at",sortOrder:"desc"},loading:!1,loadingCustomer:!1,loadingConversations:!1,loadingStats:!1,error:null}),getters:{hasCustomers:t=>t.customers.length>0,totalCustomers:t=>t.pagination.total,activeFiltersCount:t=>{let o=0;return t.filters.search&&o++,t.filters.platform&&o++,t.filters.tag&&o++,(t.filters.dateFrom||t.filters.dateTo)&&o++,o},customersByPlatform:t=>{const o={};return t.customers.forEach(s=>{var f;const i=((f=s.messaging_platform)==null?void 0:f.name)||"Unknown";o[i]||(o[i]=[]),o[i].push(s)}),o}},actions:{async fetchCustomers(t=1){var o,s;this.loading=!0,this.error=null;try{const i={page:t,per_page:this.pagination.perPage,sort_by:this.filters.sortBy,sort_order:this.filters.sortOrder};this.filters.search&&(i.search=this.filters.search),this.filters.platform&&(i.platform=this.filters.platform),this.filters.tag&&(i.tag=this.filters.tag),this.filters.dateFrom&&(i.date_from=this.filters.dateFrom),this.filters.dateTo&&(i.date_to=this.filters.dateTo);const f=await S.get("/customers",{params:i});return this.customers=f.data.data,this.pagination={currentPage:f.data.current_page,lastPage:f.data.last_page,perPage:f.data.per_page,total:f.data.total},f.data}catch(i){throw this.error=((s=(o=i.response)==null?void 0:o.data)==null?void 0:s.message)||"Failed to fetch customers",i}finally{this.loading=!1}},async fetchCustomer(t){var o,s;this.loadingCustomer=!0,this.error=null;try{const i=await S.get(`/customers/${t}`);return this.currentCustomer=i.data.data||i.data,this.currentCustomer}catch(i){throw this.error=((s=(o=i.response)==null?void 0:o.data)==null?void 0:s.message)||"Failed to fetch customer",i}finally{this.loadingCustomer=!1}},async createCustomer(t){var o,s;this.loading=!0,this.error=null;try{const i=await S.post("/customers",t);return this.pagination.currentPage===1&&this.customers.unshift(i.data.customer),this.pagination.total++,i.data}catch(i){throw this.error=((s=(o=i.response)==null?void 0:o.data)==null?void 0:s.message)||"Failed to create customer",i}finally{this.loading=!1}},async updateCustomer(t,o){var s,i,f;this.loading=!0,this.error=null;try{const c=await S.put(`/customers/${t}`,o),x=this.customers.findIndex(L=>L.id===t);return x!==-1&&(this.customers[x]=c.data.customer),((s=this.currentCustomer)==null?void 0:s.id)===t&&(this.currentCustomer=c.data.customer),c.data}catch(c){throw this.error=((f=(i=c.response)==null?void 0:i.data)==null?void 0:f.message)||"Failed to update customer",c}finally{this.loading=!1}},async deleteCustomer(t){var o,s,i;this.loading=!0,this.error=null;try{return await S.delete(`/customers/${t}`),this.customers=this.customers.filter(f=>f.id!==t),this.pagination.total--,((o=this.currentCustomer)==null?void 0:o.id)===t&&(this.currentCustomer=null),!0}catch(f){throw this.error=((i=(s=f.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to delete customer",f}finally{this.loading=!1}},async fetchCustomerConversations(t,o=1){var s,i;this.loadingConversations=!0,this.error=null;try{const f=await S.get(`/customers/${t}/conversations`,{params:{page:o}});return this.customerConversations=f.data.data,f.data}catch(f){throw this.error=((i=(s=f.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to fetch conversations",f}finally{this.loadingConversations=!1}},async updateCustomerNotes(t,o){var s,i,f;this.error=null;try{const c=await S.put(`/customers/${t}/notes`,{notes:o}),x=this.customers.findIndex(L=>L.id===t);return x!==-1&&(this.customers[x]=c.data.customer),((s=this.currentCustomer)==null?void 0:s.id)===t&&(this.currentCustomer=c.data.customer),c.data}catch(c){throw this.error=((f=(i=c.response)==null?void 0:i.data)==null?void 0:f.message)||"Failed to update notes",c}},async updateCustomerTags(t,o){var s,i,f;this.error=null;try{const c=await S.put(`/customers/${t}/tags`,{tags:o}),x=this.customers.findIndex(L=>L.id===t);return x!==-1&&(this.customers[x]=c.data.customer),((s=this.currentCustomer)==null?void 0:s.id)===t&&(this.currentCustomer=c.data.customer),c.data}catch(c){throw this.error=((f=(i=c.response)==null?void 0:i.data)==null?void 0:f.message)||"Failed to update tags",c}},async fetchAllTags(){try{const t=await S.get("/customers-tags");return this.allTags=t.data.tags,t.data.tags}catch(t){return console.error("Failed to fetch tags:",t),[]}},async fetchStats(){var t,o;this.loadingStats=!0,this.error=null;try{const s=await S.get("/customers-stats");return this.stats=s.data,s.data}catch(s){throw this.error=((o=(t=s.response)==null?void 0:t.data)==null?void 0:o.message)||"Failed to fetch stats",s}finally{this.loadingStats=!1}},setFilters(t){this.filters={...this.filters,...t}},resetFilters(){this.filters={search:"",platform:null,tag:null,dateFrom:null,dateTo:null,sortBy:"created_at",sortOrder:"desc"}},clearCurrentCustomer(){this.currentCustomer=null,this.customerConversations=[]}}});var ht=`
    .p-drawer {
        display: flex;
        flex-direction: column;
        transform: translate3d(0px, 0px, 0px);
        position: relative;
        transition: transform 0.3s;
        background: dt('drawer.background');
        color: dt('drawer.color');
        border-style: solid;
        border-color: dt('drawer.border.color');
        box-shadow: dt('drawer.shadow');
    }

    .p-drawer-content {
        overflow-y: auto;
        flex-grow: 1;
        padding: dt('drawer.content.padding');
    }

    .p-drawer-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-shrink: 0;
        padding: dt('drawer.header.padding');
    }

    .p-drawer-footer {
        padding: dt('drawer.footer.padding');
    }

    .p-drawer-title {
        font-weight: dt('drawer.title.font.weight');
        font-size: dt('drawer.title.font.size');
    }

    .p-drawer-full .p-drawer {
        transition: none;
        transform: none;
        width: 100vw !important;
        height: 100vh !important;
        max-height: 100%;
        top: 0px !important;
        left: 0px !important;
        border-width: 1px;
    }

    .p-drawer-left .p-drawer-enter-active {
        animation: p-animate-drawer-enter-left 0.5s cubic-bezier(0.32, 0.72, 0, 1);
    }
    .p-drawer-left .p-drawer-leave-active {
        animation: p-animate-drawer-leave-left 0.5s cubic-bezier(0.32, 0.72, 0, 1);
    }

    .p-drawer-right .p-drawer-enter-active {
        animation: p-animate-drawer-enter-right 0.5s cubic-bezier(0.32, 0.72, 0, 1);
    }
    .p-drawer-right .p-drawer-leave-active {
        animation: p-animate-drawer-leave-right 0.5s cubic-bezier(0.32, 0.72, 0, 1);
    }

    .p-drawer-top .p-drawer-enter-active {
        animation: p-animate-drawer-enter-top 0.5s cubic-bezier(0.32, 0.72, 0, 1);
    }
    .p-drawer-top .p-drawer-leave-active {
        animation: p-animate-drawer-leave-top 0.5s cubic-bezier(0.32, 0.72, 0, 1);
    }

    .p-drawer-bottom .p-drawer-enter-active {
        animation: p-animate-drawer-enter-bottom 0.5s cubic-bezier(0.32, 0.72, 0, 1);
    }
    .p-drawer-bottom .p-drawer-leave-active {
        animation: p-animate-drawer-leave-bottom 0.5s cubic-bezier(0.32, 0.72, 0, 1);
    }

    .p-drawer-full .p-drawer-enter-active {
        animation: p-animate-drawer-enter-full 0.5s cubic-bezier(0.32, 0.72, 0, 1);
    }
    .p-drawer-full .p-drawer-leave-active {
        animation: p-animate-drawer-leave-full 0.5s cubic-bezier(0.32, 0.72, 0, 1);
    }
    
    .p-drawer-left .p-drawer {
        width: 20rem;
        height: 100%;
        border-inline-end-width: 1px;
    }

    .p-drawer-right .p-drawer {
        width: 20rem;
        height: 100%;
        border-inline-start-width: 1px;
    }

    .p-drawer-top .p-drawer {
        height: 10rem;
        width: 100%;
        border-block-end-width: 1px;
    }

    .p-drawer-bottom .p-drawer {
        height: 10rem;
        width: 100%;
        border-block-start-width: 1px;
    }

    .p-drawer-left .p-drawer-content,
    .p-drawer-right .p-drawer-content,
    .p-drawer-top .p-drawer-content,
    .p-drawer-bottom .p-drawer-content {
        width: 100%;
        height: 100%;
    }

    .p-drawer-open {
        display: flex;
    }

    .p-drawer-mask:dir(rtl) {
        flex-direction: row-reverse;
    }

    @keyframes p-animate-drawer-enter-left {
        from {
            transform: translate3d(-100%, 0px, 0px);
        }
    }

    @keyframes p-animate-drawer-leave-left {
        to {
            transform: translate3d(-100%, 0px, 0px);
        }
    }

    @keyframes p-animate-drawer-enter-right {
        from {
            transform: translate3d(100%, 0px, 0px);
        }
    }

    @keyframes p-animate-drawer-leave-right {
        to {
            transform: translate3d(100%, 0px, 0px);
        }
    }

    @keyframes p-animate-drawer-enter-top {
        from {
            transform: translate3d(0px, -100%, 0px);
        }
    }

    @keyframes p-animate-drawer-leave-top {
        to {
            transform: translate3d(0px, -100%, 0px);
        }
    }

    @keyframes p-animate-drawer-enter-bottom {
        from {
            transform: translate3d(0px, 100%, 0px);
        }
    }

    @keyframes p-animate-drawer-leave-bottom {
        to {
            transform: translate3d(0px, 100%, 0px);
        }
    }

    @keyframes p-animate-drawer-enter-full {
        from {
            opacity: 0;
            transform: scale(0.93);
        }
    }

    @keyframes p-animate-drawer-leave-full {
        to {
            opacity: 0;
            transform: scale(0.93);
        }
    }
`,gt={mask:function(o){var s=o.position,i=o.modal;return{position:"fixed",height:"100%",width:"100%",left:0,top:0,display:"flex",justifyContent:s==="left"?"flex-start":s==="right"?"flex-end":"center",alignItems:s==="top"?"flex-start":s==="bottom"?"flex-end":"center",pointerEvents:i?"auto":"none"}},root:{pointerEvents:"auto"}},yt={mask:function(o){var s=o.instance,i=o.props,f=["left","right","top","bottom"],c=f.find(function(x){return x===i.position});return["p-drawer-mask",{"p-overlay-mask p-overlay-mask-enter-active":i.modal,"p-drawer-open":s.containerVisible,"p-drawer-full":s.fullScreen},c?"p-drawer-".concat(c):""]},root:function(o){var s=o.instance;return["p-drawer p-component",{"p-drawer-full":s.fullScreen}]},header:"p-drawer-header",title:"p-drawer-title",pcCloseButton:"p-drawer-close-button",content:"p-drawer-content",footer:"p-drawer-footer"},bt=We.extend({name:"drawer",style:ht,classes:yt,inlineStyles:gt}),wt={name:"BaseDrawer",extends:Xe,props:{visible:{type:Boolean,default:!1},position:{type:String,default:"left"},header:{type:null,default:null},baseZIndex:{type:Number,default:0},autoZIndex:{type:Boolean,default:!0},dismissable:{type:Boolean,default:!0},showCloseIcon:{type:Boolean,default:!0},closeButtonProps:{type:Object,default:function(){return{severity:"secondary",text:!0,rounded:!0}}},closeIcon:{type:String,default:void 0},modal:{type:Boolean,default:!0},blockScroll:{type:Boolean,default:!1},closeOnEscape:{type:Boolean,default:!0}},style:bt,provide:function(){return{$pcDrawer:this,$parentInstance:this}}};function M(t){"@babel/helpers - typeof";return M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},M(t)}function ee(t,o,s){return(o=Ct(o))in t?Object.defineProperty(t,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[o]=s,t}function Ct(t){var o=xt(t,"string");return M(o)=="symbol"?o:o+""}function xt(t,o){if(M(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var i=s.call(t,o);if(M(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(t)}var ge={name:"Drawer",extends:wt,inheritAttrs:!1,emits:["update:visible","show","after-show","hide","after-hide","before-hide"],data:function(){return{containerVisible:this.visible}},container:null,mask:null,content:null,headerContainer:null,footerContainer:null,closeButton:null,outsideClickListener:null,documentKeydownListener:null,watch:{dismissable:function(o){o&&!this.modal?this.bindOutsideClickListener():this.unbindOutsideClickListener()}},updated:function(){this.visible&&(this.containerVisible=this.visible)},beforeUnmount:function(){this.disableDocumentSettings(),this.mask&&this.autoZIndex&&X.clear(this.mask),this.container=null,this.mask=null},methods:{hide:function(){this.$emit("update:visible",!1)},onEnter:function(){this.$emit("show"),this.focus(),this.bindDocumentKeyDownListener(),this.autoZIndex&&X.set("modal",this.mask,this.baseZIndex||this.$primevue.config.zIndex.modal)},onAfterEnter:function(){this.enableDocumentSettings(),this.$emit("after-show")},onBeforeLeave:function(){this.modal&&!this.isUnstyled&&tt(this.mask,"p-overlay-mask-leave-active"),this.$emit("before-hide")},onLeave:function(){this.$emit("hide")},onAfterLeave:function(){this.autoZIndex&&X.clear(this.mask),this.unbindDocumentKeyDownListener(),this.containerVisible=!1,this.disableDocumentSettings(),this.$emit("after-hide")},onMaskClick:function(o){this.dismissable&&this.modal&&this.mask===o.target&&this.hide()},focus:function(){var o=function(f){return f&&f.querySelector("[autofocus]")},s=this.$slots.header&&o(this.headerContainer);s||(s=this.$slots.default&&o(this.container),s||(s=this.$slots.footer&&o(this.footerContainer),s||(s=this.closeButton))),s&&et(s)},enableDocumentSettings:function(){this.dismissable&&!this.modal&&this.bindOutsideClickListener(),this.blockScroll&&pt()},disableDocumentSettings:function(){this.unbindOutsideClickListener(),this.blockScroll&&mt()},onKeydown:function(o){o.code==="Escape"&&this.closeOnEscape&&this.hide()},containerRef:function(o){this.container=o},maskRef:function(o){this.mask=o},contentRef:function(o){this.content=o},headerContainerRef:function(o){this.headerContainer=o},footerContainerRef:function(o){this.footerContainer=o},closeButtonRef:function(o){this.closeButton=o?o.$el:void 0},bindDocumentKeyDownListener:function(){this.documentKeydownListener||(this.documentKeydownListener=this.onKeydown,document.addEventListener("keydown",this.documentKeydownListener))},unbindDocumentKeyDownListener:function(){this.documentKeydownListener&&(document.removeEventListener("keydown",this.documentKeydownListener),this.documentKeydownListener=null)},bindOutsideClickListener:function(){var o=this;this.outsideClickListener||(this.outsideClickListener=function(s){o.isOutsideClicked(s)&&o.hide()},document.addEventListener("click",this.outsideClickListener,!0))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener,!0),this.outsideClickListener=null)},isOutsideClicked:function(o){return this.container&&!this.container.contains(o.target)}},computed:{fullScreen:function(){return this.position==="full"},closeAriaLabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.close:void 0},dataP:function(){return Ye(ee(ee(ee({"full-screen":this.position==="full"},this.position,this.position),"open",this.containerVisible),"modal",this.modal))}},directives:{focustrap:Qe},components:{Button:w,Portal:Je,TimesIcon:He}},kt=["data-p"],_t=["role","aria-modal","data-p"];function Vt(t,o,s,i,f,c){var x=me("Button"),L=me("Portal"),m=he("focustrap");return d(),_(L,null,{default:v(function(){return[f.containerVisible?(d(),p("div",P({key:0,ref:c.maskRef,onMousedown:o[0]||(o[0]=function(){return c.onMaskClick&&c.onMaskClick.apply(c,arguments)}),class:t.cx("mask"),style:t.sx("mask",!0,{position:t.position,modal:t.modal}),"data-p":c.dataP},t.ptm("mask")),[u(st,P({name:"p-drawer",onEnter:c.onEnter,onAfterEnter:c.onAfterEnter,onBeforeLeave:c.onBeforeLeave,onLeave:c.onLeave,onAfterLeave:c.onAfterLeave,appear:""},t.ptm("transition")),{default:v(function(){return[t.visible?$((d(),p("div",P({key:0,ref:c.containerRef,class:t.cx("root"),style:t.sx("root"),role:t.modal?"dialog":"complementary","aria-modal":t.modal?!0:void 0,"data-p":c.dataP},t.ptmi("root")),[t.$slots.container?R(t.$slots,"container",{key:0,closeCallback:c.hide}):(d(),p(E,{key:1},[r("div",P({ref:c.headerContainerRef,class:t.cx("header")},t.ptm("header")),[R(t.$slots,"header",{class:te(t.cx("title"))},function(){return[t.header?(d(),p("div",P({key:0,class:t.cx("title")},t.ptm("title")),b(t.header),17)):C("",!0)]}),t.showCloseIcon?R(t.$slots,"closebutton",{key:0,closeCallback:c.hide},function(){return[u(x,P({ref:c.closeButtonRef,type:"button",class:t.cx("pcCloseButton"),"aria-label":c.closeAriaLabel,unstyled:t.unstyled,onClick:c.hide},t.closeButtonProps,{pt:t.ptm("pcCloseButton"),"data-pc-group-section":"iconcontainer"}),{icon:v(function(g){return[R(t.$slots,"closeicon",{},function(){return[(d(),_(at(t.closeIcon?"span":"TimesIcon"),P({class:[t.closeIcon,g.class]},t.ptm("pcCloseButton").icon),null,16,["class"]))]})]}),_:3},16,["class","aria-label","unstyled","onClick","pt"])]}):C("",!0)],16),r("div",P({ref:c.contentRef,class:t.cx("content")},t.ptm("content")),[R(t.$slots,"default")],16),t.$slots.footer?(d(),p("div",P({key:0,ref:c.footerContainerRef,class:t.cx("footer")},t.ptm("footer")),[R(t.$slots,"footer")],16)):C("",!0)],64))],16,_t)),[[m]]):C("",!0)]}),_:3},16,["onEnter","onAfterEnter","onBeforeLeave","onLeave","onAfterLeave"])],16,kt)):C("",!0)]}),_:3})}ge.render=Vt;const Lt={class:"space-y-6"},Tt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},St={class:"flex items-center gap-4"},$t={class:"text-sm text-surface-500 dark:text-surface-400"},Dt={key:0,class:"text-2xl font-bold"},Et={key:1,class:"text-2xl font-bold text-surface-900 dark:text-surface-100"},At={class:"flex flex-wrap items-center justify-between gap-4"},Pt={class:"flex flex-wrap items-center gap-3"},Bt={class:"text-center py-12 text-surface-500"},Ft={class:"flex items-center gap-3"},It={class:"font-medium text-surface-900 dark:text-surface-100"},Nt={key:0,class:"text-sm text-surface-500"},Ut={key:0},Rt={key:1,class:"text-surface-400"},zt={key:1,class:"text-surface-400"},Kt={key:1,class:"text-surface-400"},Ot=["onClick"],jt={key:0,class:"flex flex-wrap gap-1"},Mt={key:1,class:"text-surface-400"},Zt={class:"flex items-center gap-1"},qt={class:"space-y-4"},Gt={key:0,class:"text-red-500"},Wt={key:0,class:"text-red-500"},Ht={key:0,class:"text-red-500"},Jt={class:"flex gap-2 mb-2"},Qt={class:"flex flex-wrap gap-2"},Xt={class:"space-y-4"},Yt={key:0,class:"text-red-500"},es={key:0,class:"text-red-500"},ts={key:0,class:"text-red-500"},ss={class:"flex gap-2 mb-2"},as={class:"flex flex-wrap gap-2"},ns={class:"flex items-center gap-3"},rs={class:"text-lg font-semibold"},os={class:"text-sm text-surface-500"},ls={key:0,class:"space-y-4"},is={key:1,class:"space-y-6"},us={class:"grid grid-cols-2 gap-4"},ds={class:"font-medium"},cs={class:"font-medium"},ms={key:1},ps={class:"font-medium"},fs={class:"grid grid-cols-2 gap-4"},vs={class:"text-center p-4 bg-surface-50 dark:bg-surface-700 rounded-lg"},hs={class:"text-2xl font-bold text-primary-500"},gs={class:"text-center p-4 bg-surface-50 dark:bg-surface-700 rounded-lg"},ys={class:"text-2xl font-bold text-green-500"},bs={class:"flex items-center justify-between"},ws={key:0},Cs={class:"flex gap-2 mb-3"},xs={class:"flex flex-wrap gap-2 mb-3"},ks={key:0,class:"text-surface-400"},_s={class:"flex justify-end gap-2"},Vs={key:1},Ls={class:"flex flex-wrap gap-2 mb-3"},Ts={key:0,class:"text-surface-400"},Ss={class:"flex items-center justify-between"},$s={key:0},Ds={class:"flex justify-end gap-2"},Es={key:1,class:"whitespace-pre-wrap"},As={key:0,class:"space-y-3"},Ps={key:1,class:"text-center py-6 text-surface-500"},Bs={key:2,class:"space-y-3"},Fs=["onClick","onKeyup"],Is={class:"flex-1"},Ns={class:"font-medium text-sm text-surface-900 dark:text-surface-100 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors"},Us={class:"text-xs text-surface-500"},Rs={key:0,class:"text-xs text-surface-400 mt-1 truncate max-w-[250px]"},zs={class:"flex items-center gap-2"},aa={__name:"Index",setup(t){const o=it(),s=vt(),i=nt(),f=rt(),c=k(!1),x=k(!1),L=k(!1),m=k({name:"",email:"",phone:"",language:"en",notes:"",tags:[]}),g=k({}),A=k(""),se=k(!0),ye=k([{label:"All Platforms",value:null},{label:"WhatsApp",value:1},{label:"Messenger",value:2},{label:"Instagram",value:3},{label:"Telegram",value:4},{label:"WeChat",value:5},{label:"LINE",value:6}]),be=[{label:"Newest First",value:"created_at-desc"},{label:"Oldest First",value:"created_at-asc"},{label:"Name A-Z",value:"name-asc"},{label:"Name Z-A",value:"name-desc"}],Z=k("created_at-desc"),we=pe(()=>[{label:"All Tags",value:null},...s.allTags.map(l=>({label:l,value:l}))]),Q=k(!1),ae=[{label:"English",value:"en"},{label:"Spanish",value:"es"},{label:"French",value:"fr"},{label:"German",value:"de"},{label:"Portuguese",value:"pt"},{label:"Chinese",value:"zh"},{label:"Japanese",value:"ja"},{label:"Korean",value:"ko"},{label:"Arabic",value:"ar"}];ot(async()=>{await Promise.all([s.fetchCustomers(),s.fetchStats(),s.fetchAllTags()]),se.value=!1}),lt(Z,l=>{const[e,h]=l.split("-");s.setFilters({sortBy:e,sortOrder:h}),s.fetchCustomers(1)});const Ce=pe(()=>{var l,e,h;return[{label:"Total Customers",value:((l=s.stats)==null?void 0:l.total)||0,icon:"pi-users",color:"bg-blue-500"},{label:"New This Month",value:((e=s.stats)==null?void 0:e.new_this_month)||0,icon:"pi-user-plus",color:"bg-green-500"},{label:"Active (30 days)",value:((h=s.stats)==null?void 0:h.active_last_30_days)||0,icon:"pi-chart-line",color:"bg-purple-500"}]});function ne(l){return l?l.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"?"}function xe(l){return{whatsapp:"pi-whatsapp",messenger:"pi-facebook",instagram:"pi-instagram",telegram:"pi-telegram",wechat:"pi-weixin",line:"pi-comment"}[l==null?void 0:l.toLowerCase()]||"pi-comment"}function re(l){return{whatsapp:"success",messenger:"info",instagram:"warn",telegram:"info",wechat:"success",line:"success"}[l==null?void 0:l.toLowerCase()]||"secondary"}function ke(l){return{new:"New",returning:"Returning",vip:"VIP"}[l]||l}function _e(l){return{new:"info",returning:"success",vip:"warn"}[l]||"secondary"}function Ve(l){return"pi "+({new:"pi-user-plus",returning:"pi-refresh",vip:"pi-star-fill"}[l]||"pi-user")}function oe(l){return l?new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-"}function Le(l){return l?new Date(l).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}let le=null;function Te(){clearTimeout(le),le=setTimeout(()=>{s.fetchCustomers(1)},300)}function Se(){s.resetFilters(),Z.value="created_at-desc",s.fetchCustomers(1)}function $e(l){s.fetchCustomers(l.page+1)}function ie(){De(),c.value=!0}function De(){m.value={name:"",email:"",phone:"",language:"en",notes:"",tags:[]},g.value={},A.value=""}async function Ee(){var l,e,h,a;if(g.value={},!m.value.name.trim()){g.value.name="Name is required";return}try{await s.createCustomer({name:m.value.name,email:m.value.email||null,phone:m.value.phone||null,language:m.value.language,metadata:{notes:m.value.notes,tags:m.value.tags}}),i.add({severity:"success",summary:"Customer Created",detail:"Customer has been created successfully",life:3e3}),c.value=!1,s.fetchStats()}catch(y){(e=(l=y.response)==null?void 0:l.data)!=null&&e.errors?g.value=y.response.data.errors:i.add({severity:"error",summary:"Error",detail:((a=(h=y.response)==null?void 0:h.data)==null?void 0:a.message)||"Failed to create customer",life:5e3})}}function Ae(l){var e,h;m.value={id:l.id,name:l.name||"",email:l.email||"",phone:l.phone||"",language:l.language||"en",notes:((e=l.metadata)==null?void 0:e.notes)||"",tags:((h=l.metadata)==null?void 0:h.tags)||[]},g.value={},x.value=!0}async function Pe(){var l,e,h,a,y;if(g.value={},!m.value.name.trim()){g.value.name="Name is required";return}try{await s.updateCustomer(m.value.id,{name:m.value.name,email:m.value.email||null,phone:m.value.phone||null,language:m.value.language,metadata:{...(l=s.currentCustomer)==null?void 0:l.metadata,notes:m.value.notes,tags:m.value.tags}}),i.add({severity:"success",summary:"Customer Updated",detail:"Customer has been updated successfully",life:3e3}),x.value=!1}catch(T){(h=(e=T.response)==null?void 0:e.data)!=null&&h.errors?g.value=T.response.data.errors:i.add({severity:"error",summary:"Error",detail:((y=(a=T.response)==null?void 0:a.data)==null?void 0:y.message)||"Failed to update customer",life:5e3})}}async function Be(l){L.value=!0,await Promise.all([s.fetchCustomer(l.id),s.fetchCustomerConversations(l.id)])}function Fe(){L.value=!1,s.clearCurrentCustomer()}function Ie(l){if(l.conversations_count>0){const e=encodeURIComponent(l.name||l.email);o.push(`/conversations?search=${e}`)}else i.add({severity:"info",summary:"No Conversations",detail:"This customer has no conversations yet",life:3e3})}function Ne(l){f.require({message:`Are you sure you want to delete "${l.name}"? This action cannot be undone.`,header:"Delete Customer",icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-text",acceptClass:"p-button-danger",accept:async()=>{var e,h;try{await s.deleteCustomer(l.id),i.add({severity:"success",summary:"Deleted",detail:"Customer has been deleted",life:3e3}),s.fetchStats()}catch(a){i.add({severity:"error",summary:"Error",detail:((h=(e=a.response)==null?void 0:e.data)==null?void 0:h.message)||"Failed to delete customer",life:5e3})}}})}function q(){A.value.trim()&&!m.value.tags.includes(A.value.trim())&&(m.value.tags.push(A.value.trim()),A.value="")}function ue(l){m.value.tags=m.value.tags.filter(e=>e!==l)}const K=k(!1),G=k("");function Ue(){var l,e;G.value=((e=(l=s.currentCustomer)==null?void 0:l.metadata)==null?void 0:e.notes)||"",K.value=!0}async function Re(){try{await s.updateCustomerNotes(s.currentCustomer.id,G.value),K.value=!1,i.add({severity:"success",summary:"Notes Updated",detail:"Customer notes have been updated",life:3e3})}catch{i.add({severity:"error",summary:"Error",detail:"Failed to update notes",life:5e3})}}function ze(){K.value=!1}const O=k(!1),B=k([]),U=k("");function Ke(){var l,e;B.value=[...((e=(l=s.currentCustomer)==null?void 0:l.metadata)==null?void 0:e.tags)||[]],O.value=!0}function de(){U.value.trim()&&!B.value.includes(U.value.trim())&&(B.value.push(U.value.trim()),U.value="")}function Oe(l){B.value=B.value.filter(e=>e!==l)}async function je(){try{await s.updateCustomerTags(s.currentCustomer.id,B.value),O.value=!1,s.fetchAllTags(),i.add({severity:"success",summary:"Tags Updated",detail:"Customer tags have been updated",life:3e3})}catch{i.add({severity:"error",summary:"Error",detail:"Failed to update tags",life:5e3})}}function Me(){O.value=!1}async function Ze(){var l,e,h;if((l=s.currentCustomer)!=null&&l.id){Q.value=!0;try{const a=await S.post(`/customers/${s.currentCustomer.id}/generate-insights`);a.data.customer&&(s.currentCustomer=a.data.customer),s.fetchAllTags(),i.add({severity:"success",summary:"Insights Generated",detail:a.data.message||"AI insights have been generated for this customer",life:3e3})}catch(a){i.add({severity:"error",summary:"Error",detail:((h=(e=a.response)==null?void 0:e.data)==null?void 0:h.message)||"Failed to generate AI insights",life:5e3})}finally{Q.value=!1}}}function qe(l){return{open:"info",pending:"warn",resolved:"success",closed:"secondary"}[l]||"secondary"}function ce(l){L.value=!1,o.push(`/conversations?id=${l}`)}return(l,e)=>{const h=he("tooltip");return d(),p(E,null,[u(n(ft)),r("div",Lt,[r("div",Tt,[(d(!0),p(E,null,F(Ce.value,a=>(d(),_(n(N),{key:a.label,class:"border-0"},{content:v(()=>[r("div",St,[r("div",{class:te(["w-12 h-12 rounded-lg flex items-center justify-center text-white",a.color])},[r("i",{class:te(["pi",a.icon,"text-xl"])},null,2)],2),r("div",null,[r("p",$t,b(a.label),1),se.value?(d(),p("p",Dt,[u(n(J),{width:"60px",height:"28px"})])):(d(),p("p",Et,b(a.value.toLocaleString()),1))])])]),_:2},1024))),128))]),u(n(N),null,{content:v(()=>[r("div",At,[r("div",Pt,[u(n(D),{modelValue:n(s).filters.search,"onUpdate:modelValue":e[0]||(e[0]=a=>n(s).filters.search=a),placeholder:"Search customers...",class:"w-64",onInput:Te},null,8,["modelValue"]),u(n(j),{modelValue:n(s).filters.platform,"onUpdate:modelValue":e[1]||(e[1]=a=>n(s).filters.platform=a),options:ye.value,optionLabel:"label",optionValue:"value",placeholder:"Platform",class:"w-44",onChange:e[2]||(e[2]=a=>n(s).fetchCustomers(1))},null,8,["modelValue","options"]),u(n(j),{modelValue:n(s).filters.tag,"onUpdate:modelValue":e[3]||(e[3]=a=>n(s).filters.tag=a),options:we.value,optionLabel:"label",optionValue:"value",placeholder:"Filter by Tag",class:"w-44",onChange:e[4]||(e[4]=a=>n(s).fetchCustomers(1))},null,8,["modelValue","options"]),u(n(j),{modelValue:Z.value,"onUpdate:modelValue":e[5]||(e[5]=a=>Z.value=a),options:be,optionLabel:"label",optionValue:"value",placeholder:"Sort by",class:"w-44"},null,8,["modelValue"]),n(s).activeFiltersCount>0?(d(),_(n(w),{key:0,label:"Clear Filters",icon:"pi pi-filter-slash",severity:"secondary",text:"",onClick:Se})):C("",!0)]),u(n(w),{label:"Add Customer",icon:"pi pi-plus",onClick:ie})])]),_:1}),u(n(N),null,{content:v(()=>[u(n(ct),{value:n(s).customers,loading:n(s).loading,paginator:!0,rows:n(s).pagination.perPage,totalRecords:n(s).pagination.total,lazy:!0,onPage:$e,dataKey:"id",stripedRows:"",responsiveLayout:"scroll",class:"p-datatable-sm"},{empty:v(()=>[r("div",Bt,[e[25]||(e[25]=r("i",{class:"pi pi-users text-5xl mb-4 block opacity-50"},null,-1)),e[26]||(e[26]=r("p",{class:"text-lg mb-2"},"No customers found",-1)),e[27]||(e[27]=r("p",{class:"text-sm mb-4"},"Get started by adding your first customer",-1)),u(n(w),{label:"Add Customer",icon:"pi pi-plus",onClick:ie})])]),default:v(()=>[u(n(I),{header:"Customer",style:{"min-width":"250px"}},{body:v(({data:a})=>[r("div",Ft,[u(n(fe),{label:ne(a.name),image:a.profile_photo_url,shape:"circle",class:"bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300"},null,8,["label","image"]),r("div",null,[r("p",It,b(a.name||"Unknown"),1),a.email?(d(),p("p",Nt,b(a.email),1)):C("",!0)])])]),_:1}),u(n(I),{field:"phone",header:"Phone",style:{width:"150px"}},{body:v(({data:a})=>[a.phone?(d(),p("span",Ut,b(a.phone),1)):(d(),p("span",Rt,"-"))]),_:1}),u(n(I),{header:"Platform",style:{width:"130px"}},{body:v(({data:a})=>[a.messaging_platform?(d(),_(n(H),{key:0,value:a.messaging_platform.name,severity:re(a.messaging_platform.name),icon:"pi "+xe(a.messaging_platform.name)},null,8,["value","severity","icon"])):(d(),p("span",zt,"-"))]),_:1}),u(n(I),{header:"Type",style:{width:"110px"}},{body:v(({data:a})=>[a.customer_type?(d(),_(n(H),{key:0,value:ke(a.customer_type),severity:_e(a.customer_type),icon:Ve(a.customer_type)},null,8,["value","severity","icon"])):(d(),p("span",Kt,"-"))]),_:1}),u(n(I),{header:"Conversations",style:{width:"130px"}},{body:v(({data:a})=>[$((d(),p("div",{class:"flex items-center gap-2 cursor-pointer hover:text-primary-500 transition-colors",onClick:ut(y=>Ie(a),["stop"])},[e[28]||(e[28]=r("i",{class:"pi pi-comments"},null,-1)),r("span",null,b(a.conversations_count||0),1)],8,Ot)),[[h,"View conversations",void 0,{top:!0}]])]),_:1}),u(n(I),{header:"Tags",style:{"min-width":"150px"}},{body:v(({data:a})=>{var y,T;return[(T=(y=a.metadata)==null?void 0:y.tags)!=null&&T.length?(d(),p("div",jt,[(d(!0),p(E,null,F(a.metadata.tags.slice(0,2),V=>(d(),_(n(z),{key:V,label:V,class:"text-xs"},null,8,["label"]))),128)),a.metadata.tags.length>2?(d(),_(n(z),{key:0,label:"+"+(a.metadata.tags.length-2),class:"text-xs bg-surface-100 dark:bg-surface-700"},null,8,["label"])):C("",!0)])):(d(),p("span",Mt,"-"))]}),_:1}),u(n(I),{field:"created_at",header:"Created",style:{width:"130px"}},{body:v(({data:a})=>[dt(b(oe(a.created_at)),1)]),_:1}),u(n(I),{header:"Actions",style:{width:"160px"}},{body:v(({data:a})=>[r("div",Zt,[$(u(n(w),{icon:"pi pi-eye",severity:"info",outlined:"",rounded:"",size:"small",onClick:y=>Be(a)},null,8,["onClick"]),[[h,"View Details",void 0,{top:!0}]]),$(u(n(w),{icon:"pi pi-pencil",severity:"secondary",outlined:"",rounded:"",size:"small",onClick:y=>Ae(a)},null,8,["onClick"]),[[h,"Edit",void 0,{top:!0}]]),$(u(n(w),{icon:"pi pi-trash",severity:"danger",outlined:"",rounded:"",size:"small",onClick:y=>Ne(a)},null,8,["onClick"]),[[h,"Delete",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","loading","rows","totalRecords"])]),_:1})]),u(n(ve),{visible:c.value,"onUpdate:visible":e[13]||(e[13]=a=>c.value=a),header:"Add Customer",modal:"",style:{width:"500px"},closable:!0},{footer:v(()=>[u(n(w),{label:"Cancel",severity:"secondary",outlined:"",onClick:e[12]||(e[12]=a=>c.value=!1)}),u(n(w),{label:"Create Customer",icon:"pi pi-check",onClick:Ee,loading:n(s).loading},null,8,["loading"])]),default:v(()=>[r("div",qt,[r("div",null,[e[29]||(e[29]=r("label",{class:"block text-sm font-medium mb-1"},"Name *",-1)),u(n(D),{modelValue:m.value.name,"onUpdate:modelValue":e[6]||(e[6]=a=>m.value.name=a),class:"w-full",invalid:!!g.value.name,placeholder:"Customer name"},null,8,["modelValue","invalid"]),g.value.name?(d(),p("small",Gt,b(g.value.name),1)):C("",!0)]),r("div",null,[e[30]||(e[30]=r("label",{class:"block text-sm font-medium mb-1"},"Email",-1)),u(n(D),{modelValue:m.value.email,"onUpdate:modelValue":e[7]||(e[7]=a=>m.value.email=a),class:"w-full",invalid:!!g.value.email,placeholder:"customer@example.com"},null,8,["modelValue","invalid"]),g.value.email?(d(),p("small",Wt,b(g.value.email),1)):C("",!0)]),r("div",null,[e[31]||(e[31]=r("label",{class:"block text-sm font-medium mb-1"},"Phone",-1)),u(n(D),{modelValue:m.value.phone,"onUpdate:modelValue":e[8]||(e[8]=a=>m.value.phone=a),class:"w-full",invalid:!!g.value.phone,placeholder:"+1 234 567 8900"},null,8,["modelValue","invalid"]),g.value.phone?(d(),p("small",Ht,b(g.value.phone),1)):C("",!0)]),r("div",null,[e[32]||(e[32]=r("label",{class:"block text-sm font-medium mb-1"},"Language",-1)),u(n(j),{modelValue:m.value.language,"onUpdate:modelValue":e[9]||(e[9]=a=>m.value.language=a),options:ae,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue"])]),r("div",null,[e[33]||(e[33]=r("label",{class:"block text-sm font-medium mb-1"},"Tags",-1)),r("div",Jt,[u(n(D),{modelValue:A.value,"onUpdate:modelValue":e[10]||(e[10]=a=>A.value=a),class:"flex-1",placeholder:"Add a tag...",onKeyup:W(q,["enter"])},null,8,["modelValue"]),$(u(n(w),{icon:"pi pi-plus",severity:"secondary",outlined:"",onClick:q},null,512),[[h,"Add Tag",void 0,{top:!0}]])]),r("div",Qt,[(d(!0),p(E,null,F(m.value.tags,a=>(d(),_(n(z),{key:a,label:a,removable:"",onRemove:y=>ue(a)},null,8,["label","onRemove"]))),128))])]),r("div",null,[e[34]||(e[34]=r("label",{class:"block text-sm font-medium mb-1"},"Notes",-1)),u(n(Y),{modelValue:m.value.notes,"onUpdate:modelValue":e[11]||(e[11]=a=>m.value.notes=a),rows:"3",class:"w-full",placeholder:"Add notes about this customer..."},null,8,["modelValue"])])])]),_:1},8,["visible"]),u(n(ve),{visible:x.value,"onUpdate:visible":e[21]||(e[21]=a=>x.value=a),header:"Edit Customer",modal:"",style:{width:"500px"},closable:!0},{footer:v(()=>[u(n(w),{label:"Cancel",severity:"secondary",outlined:"",onClick:e[20]||(e[20]=a=>x.value=!1)}),u(n(w),{label:"Save Changes",icon:"pi pi-check",onClick:Pe,loading:n(s).loading},null,8,["loading"])]),default:v(()=>[r("div",Xt,[r("div",null,[e[35]||(e[35]=r("label",{class:"block text-sm font-medium mb-1"},"Name *",-1)),u(n(D),{modelValue:m.value.name,"onUpdate:modelValue":e[14]||(e[14]=a=>m.value.name=a),class:"w-full",invalid:!!g.value.name},null,8,["modelValue","invalid"]),g.value.name?(d(),p("small",Yt,b(g.value.name),1)):C("",!0)]),r("div",null,[e[36]||(e[36]=r("label",{class:"block text-sm font-medium mb-1"},"Email",-1)),u(n(D),{modelValue:m.value.email,"onUpdate:modelValue":e[15]||(e[15]=a=>m.value.email=a),class:"w-full",invalid:!!g.value.email},null,8,["modelValue","invalid"]),g.value.email?(d(),p("small",es,b(g.value.email),1)):C("",!0)]),r("div",null,[e[37]||(e[37]=r("label",{class:"block text-sm font-medium mb-1"},"Phone",-1)),u(n(D),{modelValue:m.value.phone,"onUpdate:modelValue":e[16]||(e[16]=a=>m.value.phone=a),class:"w-full",invalid:!!g.value.phone},null,8,["modelValue","invalid"]),g.value.phone?(d(),p("small",ts,b(g.value.phone),1)):C("",!0)]),r("div",null,[e[38]||(e[38]=r("label",{class:"block text-sm font-medium mb-1"},"Language",-1)),u(n(j),{modelValue:m.value.language,"onUpdate:modelValue":e[17]||(e[17]=a=>m.value.language=a),options:ae,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue"])]),r("div",null,[e[39]||(e[39]=r("label",{class:"block text-sm font-medium mb-1"},"Tags",-1)),r("div",ss,[u(n(D),{modelValue:A.value,"onUpdate:modelValue":e[18]||(e[18]=a=>A.value=a),class:"flex-1",placeholder:"Add a tag...",onKeyup:W(q,["enter"])},null,8,["modelValue"]),$(u(n(w),{icon:"pi pi-plus",severity:"secondary",outlined:"",onClick:q},null,512),[[h,"Add Tag",void 0,{top:!0}]])]),r("div",as,[(d(!0),p(E,null,F(m.value.tags,a=>(d(),_(n(z),{key:a,label:a,removable:"",onRemove:y=>ue(a)},null,8,["label","onRemove"]))),128))])]),r("div",null,[e[40]||(e[40]=r("label",{class:"block text-sm font-medium mb-1"},"Notes",-1)),u(n(Y),{modelValue:m.value.notes,"onUpdate:modelValue":e[19]||(e[19]=a=>m.value.notes=a),rows:"3",class:"w-full"},null,8,["modelValue"])])])]),_:1},8,["visible"]),u(n(ge),{visible:L.value,"onUpdate:visible":e[24]||(e[24]=a=>L.value=a),position:"right",style:{width:"600px"},onHide:Fe},{header:v(()=>{var a,y,T,V;return[r("div",ns,[u(n(fe),{label:ne((a=n(s).currentCustomer)==null?void 0:a.name),image:(y=n(s).currentCustomer)==null?void 0:y.profile_photo_url,shape:"circle",size:"large",class:"bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300"},null,8,["label","image"]),r("div",null,[r("h2",rs,b(((T=n(s).currentCustomer)==null?void 0:T.name)||"Customer"),1),r("p",os,b(((V=n(s).currentCustomer)==null?void 0:V.email)||"No email"),1)])])]}),default:v(()=>[n(s).loadingCustomer?(d(),p("div",ls,[u(n(J),{height:"100px"}),u(n(J),{height:"200px"})])):n(s).currentCustomer?(d(),p("div",is,[u(n(N),null,{title:v(()=>[...e[41]||(e[41]=[r("div",{class:"flex items-center gap-2"},[r("i",{class:"pi pi-user text-primary-500"}),r("span",null,"Contact Information")],-1)])]),content:v(()=>{var a;return[r("div",us,[r("div",null,[e[42]||(e[42]=r("p",{class:"text-sm text-surface-500"},"Phone",-1)),r("p",ds,b(n(s).currentCustomer.phone||"-"),1)]),r("div",null,[e[43]||(e[43]=r("p",{class:"text-sm text-surface-500"},"Language",-1)),r("p",cs,b(((a=n(s).currentCustomer.language)==null?void 0:a.toUpperCase())||"EN"),1)]),r("div",null,[e[44]||(e[44]=r("p",{class:"text-sm text-surface-500"},"Platform",-1)),n(s).currentCustomer.messaging_platform?(d(),_(n(H),{key:0,value:n(s).currentCustomer.messaging_platform.name,severity:re(n(s).currentCustomer.messaging_platform.name)},null,8,["value","severity"])):(d(),p("span",ms,"-"))]),r("div",null,[e[45]||(e[45]=r("p",{class:"text-sm text-surface-500"},"Customer Since",-1)),r("p",ps,b(oe(n(s).currentCustomer.created_at)),1)])])]}),_:1}),u(n(N),null,{title:v(()=>[...e[46]||(e[46]=[r("div",{class:"flex items-center gap-2"},[r("i",{class:"pi pi-chart-bar text-primary-500"}),r("span",null,"Statistics")],-1)])]),content:v(()=>[r("div",fs,[r("div",vs,[r("p",hs,b(n(s).currentCustomer.conversations_count||0),1),e[47]||(e[47]=r("p",{class:"text-sm text-surface-500"},"Conversations",-1))]),r("div",gs,[r("p",ys,b(n(s).currentCustomer.average_satisfaction?n(s).currentCustomer.average_satisfaction.toFixed(1):"-"),1),e[48]||(e[48]=r("p",{class:"text-sm text-surface-500"},"Avg. Satisfaction",-1))])])]),_:1}),u(n(N),null,{title:v(()=>[r("div",bs,[e[49]||(e[49]=r("div",{class:"flex items-center gap-2"},[r("i",{class:"pi pi-tags text-primary-500"}),r("span",null,"Tags")],-1)),O.value?C("",!0):$((d(),_(n(w),{key:0,icon:"pi pi-pencil",severity:"secondary",outlined:"",rounded:"",size:"small",onClick:Ke},null,512)),[[h,"Edit Tags",void 0,{top:!0}]])])]),content:v(()=>{var a,y,T;return[O.value?(d(),p("div",ws,[r("div",Cs,[u(n(D),{modelValue:U.value,"onUpdate:modelValue":e[22]||(e[22]=V=>U.value=V),class:"flex-1",placeholder:"Add a tag...",onKeyup:W(de,["enter"])},null,8,["modelValue"]),$(u(n(w),{icon:"pi pi-plus",severity:"secondary",outlined:"",onClick:de},null,512),[[h,"Add Tag",void 0,{top:!0}]])]),r("div",xs,[(d(!0),p(E,null,F(B.value,V=>(d(),_(n(z),{key:V,label:V,removable:"",onRemove:Ks=>Oe(V)},null,8,["label","onRemove"]))),128)),B.value.length?C("",!0):(d(),p("span",ks,"No tags"))]),r("div",_s,[u(n(w),{label:"Cancel",severity:"secondary",outlined:"",size:"small",onClick:Me}),u(n(w),{label:"Save",size:"small",onClick:je})])])):(d(),p("div",Vs,[r("div",Ls,[(d(!0),p(E,null,F(((a=n(s).currentCustomer.metadata)==null?void 0:a.tags)||[],V=>(d(),_(n(z),{key:V,label:V},null,8,["label"]))),128)),(T=(y=n(s).currentCustomer.metadata)==null?void 0:y.tags)!=null&&T.length?C("",!0):(d(),p("span",Ts,"No tags"))]),$(u(n(w),{label:"Generate AI Tags",icon:"pi pi-sparkles",severity:"secondary",size:"small",outlined:"",loading:Q.value,onClick:Ze},null,8,["loading"]),[[h,"Analyze conversations to generate tags",void 0,{top:!0}]])]))]}),_:1}),u(n(N),null,{title:v(()=>[r("div",Ss,[e[50]||(e[50]=r("div",{class:"flex items-center gap-2"},[r("i",{class:"pi pi-file-edit text-primary-500"}),r("span",null,"Notes")],-1)),K.value?C("",!0):$((d(),_(n(w),{key:0,icon:"pi pi-pencil",severity:"secondary",outlined:"",rounded:"",size:"small",onClick:Ue},null,512)),[[h,"Edit Notes",void 0,{top:!0}]])])]),content:v(()=>{var a;return[K.value?(d(),p("div",$s,[u(n(Y),{modelValue:G.value,"onUpdate:modelValue":e[23]||(e[23]=y=>G.value=y),rows:"4",class:"w-full mb-3",placeholder:"Add notes..."},null,8,["modelValue"]),r("div",Ds,[u(n(w),{label:"Cancel",severity:"secondary",outlined:"",size:"small",onClick:ze}),u(n(w),{label:"Save",size:"small",onClick:Re})])])):(d(),p("p",Es,b(((a=n(s).currentCustomer.metadata)==null?void 0:a.notes)||"No notes yet."),1))]}),_:1}),u(n(N),null,{title:v(()=>[...e[51]||(e[51]=[r("div",{class:"flex items-center gap-2"},[r("i",{class:"pi pi-comments text-primary-500"}),r("span",null,"Recent Conversations")],-1)])]),content:v(()=>[n(s).loadingConversations?(d(),p("div",As,[(d(),p(E,null,F(3,a=>u(n(J),{height:"60px",key:a})),64))])):n(s).customerConversations.length===0?(d(),p("div",Ps,[...e[52]||(e[52]=[r("i",{class:"pi pi-inbox text-3xl mb-2 block opacity-50"},null,-1),r("p",null,"No conversations yet",-1)])])):(d(),p("div",Bs,[(d(!0),p(E,null,F(n(s).customerConversations.slice(0,5),a=>(d(),p("div",{key:a.id,class:"group flex items-center justify-between p-3 bg-surface-50 dark:bg-surface-700 rounded-lg cursor-pointer hover:bg-primary-50 dark:hover:bg-primary-900/20 hover:border-primary-200 dark:hover:border-primary-700 border border-transparent transition-all",role:"button",tabindex:"0",onClick:y=>ce(a.id),onKeyup:W(y=>ce(a.id),["enter"])},[r("div",Is,[r("p",Ns,b(a.subject||"Conversation #"+a.id),1),r("p",Us,b(Le(a.created_at)),1),a.last_message?(d(),p("p",Rs,b(a.last_message),1)):C("",!0)]),r("div",zs,[u(n(H),{value:a.status,severity:qe(a.status),class:"text-xs"},null,8,["value","severity"]),e[53]||(e[53]=r("i",{class:"pi pi-external-link text-surface-400 group-hover:text-primary-500 transition-colors"},null,-1))])],40,Fs))),128))]))]),_:1})])):C("",!0)]),_:1},8,["visible"])],64)}}};export{aa as default};
