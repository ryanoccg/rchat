import{d as c,z as s}from"./app-DJ0pZO5B.js";const h=c("platforms",{state:()=>({platforms:[],connections:[],selectedConnection:null,loading:!1,saving:!1,error:null}),getters:{activeConnections:n=>n.connections.filter(e=>e.is_active),inactiveConnections:n=>n.connections.filter(e=>!e.is_active),getConnectionById:n=>e=>n.connections.find(t=>t.id===e),getPlatformById:n=>e=>n.platforms.find(t=>t.id===e)},actions:{async fetchPlatforms(){var n,e;try{const t=await s.get("/api/platforms");return this.platforms=t.data.data,this.platforms}catch(t){throw this.error=((e=(n=t.response)==null?void 0:n.data)==null?void 0:e.message)||"Failed to fetch platforms",t}},async fetchConnections(){var n,e;this.loading=!0,this.error=null;try{const t=await s.get("/api/platform-connections");return this.connections=t.data.data,this.connections}catch(t){throw this.error=((e=(n=t.response)==null?void 0:n.data)==null?void 0:e.message)||"Failed to fetch connections",t}finally{this.loading=!1}},async fetchConnection(n){var e,t;this.loading=!0,this.error=null;try{const o=await s.get(`/api/platform-connections/${n}`);return this.selectedConnection=o.data.data,this.selectedConnection}catch(o){throw this.error=((t=(e=o.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to fetch connection",o}finally{this.loading=!1}},async createConnection(n){var e,t;this.saving=!0,this.error=null;try{const o=await s.post("/api/platform-connections",n);return this.connections.push(o.data.data),o.data.data}catch(o){throw this.error=((t=(e=o.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to create connection",o}finally{this.saving=!1}},async updateConnection(n,e){var t,o;this.saving=!0,this.error=null;try{const a=await s.put(`/api/platform-connections/${n}`,e),r=this.connections.findIndex(i=>i.id===n);return r!==-1&&(this.connections[r]=a.data.data),a.data.data}catch(a){throw this.error=((o=(t=a.response)==null?void 0:t.data)==null?void 0:o.message)||"Failed to update connection",a}finally{this.saving=!1}},async deleteConnection(n){var e,t;this.saving=!0,this.error=null;try{await s.delete(`/api/platform-connections/${n}`),this.connections=this.connections.filter(o=>o.id!==n)}catch(o){throw this.error=((t=(e=o.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to delete connection",o}finally{this.saving=!1}},async toggleConnectionStatus(n){var e,t;this.error=null;try{const o=await s.post(`/api/platform-connections/${n}/toggle`),a=this.connections.findIndex(r=>r.id===n);return a!==-1&&(this.connections[a]=o.data.data),o.data}catch(o){throw this.error=((t=(e=o.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to toggle status",o}},async testConnection(n){var e,t;this.error=null;try{return(await s.post(`/api/platform-connections/${n}/test`)).data}catch(o){throw this.error=((t=(e=o.response)==null?void 0:e.data)==null?void 0:t.message)||"Connection test failed",o}},async getFacebookAuthUrl(){var n,e;this.error=null;try{return(await s.get("/api/auth/facebook/url")).data}catch(t){throw this.error=((e=(n=t.response)==null?void 0:n.data)==null?void 0:e.message)||"Failed to get Facebook auth URL",t}},async getFacebookPages(n){var e,t;this.error=null;try{return(await s.get("/api/auth/facebook/pages",{params:{fb_token:n}})).data.pages}catch(o){throw this.error=((t=(e=o.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to fetch Facebook pages",o}},async connectFacebookPage(n,e){var t,o;this.saving=!0,this.error=null;try{const a=await s.post("/api/auth/facebook/connect",{...n,fb_token:e});return a.data.connection&&this.connections.push(a.data.connection),a.data}catch(a){throw this.error=((o=(t=a.response)==null?void 0:t.data)==null?void 0:o.message)||"Failed to connect Facebook page",a}finally{this.saving=!1}},clearError(){this.error=null}}});export{h as u};
