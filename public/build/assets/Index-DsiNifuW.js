import{d as K,H as v,D as q,K as z,ag as G,b as f,m as u,e as s,G as L,q as Y,r as Z,c as k,o as J,a1 as Q,g as d,i as o,j as W,F as j,k as S,w as c,t as p,n as D,l as X,B as x,h as O}from"./app-fEyaVeNj.js";import{s as h}from"./index-B1y77kAB.js";import{s as tt}from"./index-Bf82pFXt.js";import{s as et,a as C}from"./index-Cp9vA3Ae.js";import{s as st}from"./index-DPRBmxkH.js";import{s as at}from"./index-Cbdau87T.js";import{s as N}from"./index-D6YEJdOd.js";import"./index-CUE77Sby.js";import"./index-CniEHBiC.js";import"./index-CzS5b5Kg.js";import"./index-CaKXeVtV.js";import"./index-uZHgs35Z.js";const rt=K("analytics",{state:()=>({overview:null,conversationTrends:[],sentimentData:null,satisfactionData:null,platformPerformance:[],agentPerformance:[],usageData:null,hourlyDistribution:[],loading:!1,exporting:!1,error:null,period:"30"}),getters:{hasData:e=>e.overview!==null},actions:{async fetchOverview(e=null){var t,a;e&&(this.period=e),this.loading=!0,this.error=null;try{const i=await v.get("/analytics/overview",{params:{period:this.period}});return this.overview=i.data.data,this.overview}catch(i){throw this.error=((a=(t=i.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to fetch overview",i}finally{this.loading=!1}},async fetchConversationTrends(e="day"){var t,a;try{const i=await v.get("/analytics/conversation-trends",{params:{period:this.period,group_by:e}});return this.conversationTrends=i.data.data,this.conversationTrends}catch(i){throw this.error=((a=(t=i.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to fetch trends",i}},async fetchSentimentData(){var e,t;try{const a=await v.get("/analytics/sentiment",{params:{period:this.period}});return this.sentimentData=a.data.data,this.sentimentData}catch(a){throw this.error=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to fetch sentiment data",a}},async fetchSatisfactionData(){var e,t;try{const a=await v.get("/analytics/satisfaction",{params:{period:this.period}});return this.satisfactionData=a.data.data,this.satisfactionData}catch(a){throw this.error=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to fetch satisfaction data",a}},async fetchPlatformPerformance(){var e,t;try{const a=await v.get("/analytics/platform-performance",{params:{period:this.period}});return this.platformPerformance=a.data.data,this.platformPerformance}catch(a){throw this.error=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to fetch platform performance",a}},async fetchAgentPerformance(){var e,t;try{const a=await v.get("/analytics/agent-performance",{params:{period:this.period}});return this.agentPerformance=a.data.data,this.agentPerformance}catch(a){throw this.error=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to fetch agent performance",a}},async fetchUsageData(){var e,t;try{const a=await v.get("/analytics/usage",{params:{period:this.period}});return this.usageData=a.data.data,this.usageData}catch(a){throw this.error=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to fetch usage data",a}},async fetchHourlyDistribution(){var e,t;try{const a=await v.get("/analytics/hourly-distribution",{params:{period:this.period}});return this.hourlyDistribution=a.data.data,this.hourlyDistribution}catch(a){throw this.error=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to fetch hourly distribution",a}},async fetchAllData(e=null){e&&(this.period=e),this.loading=!0,this.error=null;try{await Promise.all([this.fetchOverview(),this.fetchConversationTrends(),this.fetchSentimentData(),this.fetchSatisfactionData(),this.fetchPlatformPerformance(),this.fetchAgentPerformance(),this.fetchHourlyDistribution()])}catch(t){console.error("Failed to fetch analytics data:",t)}finally{this.loading=!1}},async exportData(e="json"){var t,a;this.exporting=!0;try{const i=await v.get("/analytics/export",{params:{period:this.period,format:e},responseType:"blob"}),m=new Blob([i.data],{type:e==="csv"?"text/csv":"application/json"}),b=window.URL.createObjectURL(m),g=document.createElement("a");return g.href=b,g.download=`analytics-${this.period}days.${e}`,g.click(),window.URL.revokeObjectURL(b),i.data}catch(i){throw this.error=((a=(t=i.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to export data",i}finally{this.exporting=!1}},setPeriod(e){this.period=e},clearError(){this.error=null}}});var nt={root:{position:"relative"}},ot={root:"p-chart"},it=q.extend({name:"chart",classes:ot,inlineStyles:nt}),lt={name:"BaseChart",extends:z,props:{type:String,data:null,options:null,plugins:null,width:{type:Number,default:300},height:{type:Number,default:150},canvasProps:{type:null,default:null}},style:it,provide:function(){return{$pcChart:this,$parentInstance:this}}},w={name:"Chart",extends:lt,inheritAttrs:!1,emits:["select","loaded"],chart:null,watch:{data:{handler:function(){this.reinit()},deep:!0},type:function(){this.reinit()},options:function(){this.reinit()}},mounted:function(){this.initChart()},beforeUnmount:function(){this.chart&&(this.chart.destroy(),this.chart=null)},methods:{initChart:function(){var t=this;G(()=>import("./auto-eE5P6S0m.js"),[]).then(function(a){t.chart&&(t.chart.destroy(),t.chart=null),a&&a.default&&(t.chart=new a.default(t.$refs.canvas,{type:t.type,data:t.data,options:t.options,plugins:t.plugins})),t.$emit("loaded",t.chart)})},getCanvas:function(){return this.$canvas},getChart:function(){return this.chart},getBase64Image:function(){return this.chart.toBase64Image()},refresh:function(){this.chart&&this.chart.update()},reinit:function(){this.initChart()},onCanvasClick:function(t){if(this.chart){var a=this.chart.getElementsAtEventForMode(t,"nearest",{intersect:!0},!1),i=this.chart.getElementsAtEventForMode(t,"dataset",{intersect:!0},!1);a&&a[0]&&i&&this.$emit("select",{originalEvent:t,element:a[0],dataset:i})}},generateLegend:function(){if(this.chart)return this.chart.generateLegend()}}};function _(e){"@babel/helpers - typeof";return _=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(e)}function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,i)}return a}function V(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?B(Object(a),!0).forEach(function(i){ct(e,i,a[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(Object(a)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(a,i))})}return e}function ct(e,t,a){return(t=dt(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function dt(e){var t=ut(e,"string");return _(t)=="symbol"?t:t+""}function ut(e,t){if(_(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var i=a.call(e,t);if(_(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ft=["width","height"];function pt(e,t,a,i,m,b){return u(),f("div",L({class:e.cx("root"),style:e.sx("root")},e.ptmi("root")),[s("canvas",L({ref:"canvas",width:e.width,height:e.height,onClick:t[0]||(t[0]=function(g){return b.onCanvasClick(g)})},V(V({},e.canvasProps),e.ptm("canvas"))),null,16,ft)],16)}w.render=pt;const ht={class:"space-y-6"},mt={class:"flex items-center justify-between"},vt={class:"flex items-center gap-3"},gt={key:0,class:"space-y-6"},yt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},bt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},xt={key:1,class:"space-y-6"},wt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},_t={class:"flex items-center justify-between"},kt={class:"text-3xl font-bold text-surface-900 dark:text-surface-100"},Dt={class:"flex items-center justify-between"},Ct={class:"text-3xl font-bold text-surface-900 dark:text-surface-100"},Pt={class:"flex items-center justify-between"},jt={class:"text-3xl font-bold text-surface-900 dark:text-surface-100"},St={class:"flex items-center justify-between"},Ot={class:"text-3xl font-bold text-surface-900 dark:text-surface-100"},$t={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},At={class:"h-80"},Tt={key:1,class:"h-full flex items-center justify-center text-surface-500"},Et={class:"h-80"},Ft={key:1,class:"h-full flex items-center justify-center text-surface-500"},Rt={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Lt={class:"h-64"},Nt={key:1,class:"h-full flex items-center justify-center text-surface-500"},Bt={key:0,class:"mt-4 text-center"},Vt={class:"text-2xl font-bold text-surface-900 dark:text-surface-100"},It={class:"h-64"},Ut={key:1,class:"h-full flex items-center justify-center text-surface-500"},Mt={key:0,class:"mt-4 grid grid-cols-2 gap-4 text-center"},Ht={class:"text-xl font-bold text-surface-900 dark:text-surface-100"},Kt={key:0,class:"space-y-4"},qt={class:"flex items-center gap-3"},zt={class:"font-medium text-surface-900 dark:text-surface-100"},Gt={class:"text-right"},Yt={class:"font-bold text-surface-900 dark:text-surface-100"},Zt={class:"text-xs text-surface-500"},Jt={key:1,class:"h-64 flex items-center justify-center text-surface-500"},Qt={class:"flex items-center gap-2"},Wt={class:"font-medium text-surface-900 dark:text-surface-100"},Xt={class:"font-bold text-surface-900 dark:text-surface-100"},te={class:"flex items-center gap-2"},ee={class:"text-surface-900 dark:text-surface-100"},he={__name:"Index",setup(e){const t=rt(),a=Y(),i=[{label:"Last 7 Days",value:"7"},{label:"Last 30 Days",value:"30"},{label:"Last 90 Days",value:"90"},{label:"Last Year",value:"365"}],m=Z("30"),b=k(()=>t.conversationTrends.length?{labels:t.conversationTrends.map(l=>l.date),datasets:[{label:"Total",data:t.conversationTrends.map(l=>l.total),borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",fill:!0,tension:.4},{label:"Resolved",data:t.conversationTrends.map(l=>l.resolved),borderColor:"#22c55e",backgroundColor:"rgba(34, 197, 94, 0.1)",fill:!0,tension:.4},{label:"AI Handled",data:t.conversationTrends.map(l=>l.ai_handled),borderColor:"#a855f7",backgroundColor:"rgba(168, 85, 247, 0.1)",fill:!0,tension:.4}]}:null),g=k(()=>{var r,n;if(!((n=(r=t.sentimentData)==null?void 0:r.distribution)!=null&&n.length))return null;const l={positive:"#22c55e",neutral:"#6b7280",negative:"#ef4444"};return{labels:t.sentimentData.distribution.map(y=>y.sentiment),datasets:[{data:t.sentimentData.distribution.map(y=>y.count),backgroundColor:t.sentimentData.distribution.map(y=>l[y.sentiment]||"#6b7280")}]}}),$=k(()=>{var l,r;return(r=(l=t.satisfactionData)==null?void 0:l.distribution)!=null&&r.length?{labels:t.satisfactionData.distribution.map(n=>`${n.rating} Star${n.rating>1?"s":""}`),datasets:[{label:"Ratings",data:t.satisfactionData.distribution.map(n=>n.count),backgroundColor:["#ef4444","#f97316","#eab308","#84cc16","#22c55e"]}]}:null}),A=k(()=>t.hourlyDistribution.length?{labels:t.hourlyDistribution.map(l=>l.label),datasets:[{label:"Conversations",data:t.hourlyDistribution.map(l=>l.count),backgroundColor:"#3b82f6"}]}:null),P={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}},T={...P,scales:{y:{beginAtZero:!0}}};J(async()=>{await E()});async function E(){try{await t.fetchAllData(m.value)}catch{a.add({severity:"error",summary:"Error",detail:"Failed to load analytics data",life:5e3})}}async function I(l){try{await t.exportData(l),a.add({severity:"success",summary:"Exported",detail:`Analytics data exported as ${l.toUpperCase()}`,life:3e3})}catch{a.add({severity:"error",summary:"Error",detail:"Failed to export data",life:5e3})}}function U(l){return l>0?"text-green-500":l<0?"text-red-500":"text-surface-500"}function M(l){return l>0?"pi pi-arrow-up":l<0?"pi pi-arrow-down":"pi pi-minus"}function H(l){return{facebook:"pi-facebook",whatsapp:"pi-whatsapp",telegram:"pi-telegram",line:"pi-comments"}[l]||"pi-comment"}return Q(m,()=>{E()}),(l,r)=>(u(),f("div",ht,[s("div",mt,[r[2]||(r[2]=s("div",null,[s("h1",{class:"text-2xl font-bold text-surface-900 dark:text-surface-100"},"Analytics"),s("p",{class:"text-surface-500 mt-1"},"Monitor your customer service performance and trends")],-1)),s("div",vt,[d(o(tt),{modelValue:m.value,"onUpdate:modelValue":r[0]||(r[0]=n=>m.value=n),options:i,optionLabel:"label",optionValue:"value",class:"w-40"},null,8,["modelValue"]),d(o(W),{icon:"pi pi-download",label:"Export CSV",severity:"secondary",loading:o(t).exporting,onClick:r[1]||(r[1]=n=>I("csv"))},null,8,["loading"])])]),o(t).loading?(u(),f("div",gt,[s("div",yt,[(u(),f(j,null,S(4,n=>d(o(h),{key:n},{content:c(()=>[d(o(N),{height:"80px"})]),_:1})),64))]),s("div",bt,[(u(),f(j,null,S(2,n=>d(o(h),{key:n},{content:c(()=>[d(o(N),{height:"300px"})]),_:1})),64))])])):(u(),f("div",xt,[s("div",wt,[d(o(h),null,{content:c(()=>{var n,y,F,R;return[s("div",_t,[s("div",null,[r[3]||(r[3]=s("p",{class:"text-sm text-surface-500 dark:text-surface-400"},"Conversations",-1)),s("p",kt,p(((n=o(t).overview)==null?void 0:n.total_conversations)||0),1),s("p",{class:D([U((y=o(t).overview)==null?void 0:y.conversation_change),"text-sm mt-1"])},[s("i",{class:D([M((F=o(t).overview)==null?void 0:F.conversation_change),"mr-1"])},null,2),X(" "+p(Math.abs(((R=o(t).overview)==null?void 0:R.conversation_change)||0))+"% vs prev ",1)],2)]),r[4]||(r[4]=s("div",{class:"w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center"},[s("i",{class:"pi pi-comments text-blue-500 text-xl"})],-1))])]}),_:1}),d(o(h),null,{content:c(()=>{var n;return[s("div",Dt,[s("div",null,[r[5]||(r[5]=s("p",{class:"text-sm text-surface-500 dark:text-surface-400"},"AI Handle Rate",-1)),s("p",Ct,p(((n=o(t).overview)==null?void 0:n.ai_handle_rate)||0)+"%",1),r[6]||(r[6]=s("p",{class:"text-sm text-surface-500 mt-1"},"Automated responses",-1))]),r[7]||(r[7]=s("div",{class:"w-12 h-12 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center"},[s("i",{class:"pi pi-bolt text-purple-500 text-xl"})],-1))])]}),_:1}),d(o(h),null,{content:c(()=>{var n;return[s("div",Pt,[s("div",null,[r[8]||(r[8]=s("p",{class:"text-sm text-surface-500 dark:text-surface-400"},"Avg Response Time",-1)),s("p",jt,p(((n=o(t).overview)==null?void 0:n.avg_response_time)||0)+"m",1),r[9]||(r[9]=s("p",{class:"text-sm text-surface-500 mt-1"},"Minutes to first response",-1))]),r[10]||(r[10]=s("div",{class:"w-12 h-12 rounded-full bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center"},[s("i",{class:"pi pi-clock text-yellow-500 text-xl"})],-1))])]}),_:1}),d(o(h),null,{content:c(()=>{var n;return[s("div",St,[s("div",null,[r[11]||(r[11]=s("p",{class:"text-sm text-surface-500 dark:text-surface-400"},"Resolution Rate",-1)),s("p",Ot,p(((n=o(t).overview)==null?void 0:n.resolution_rate)||0)+"%",1),r[12]||(r[12]=s("p",{class:"text-sm text-surface-500 mt-1"},"Conversations resolved",-1))]),r[13]||(r[13]=s("div",{class:"w-12 h-12 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center"},[s("i",{class:"pi pi-check-circle text-green-500 text-xl"})],-1))])]}),_:1})]),s("div",$t,[d(o(h),null,{title:c(()=>[...r[14]||(r[14]=[s("span",{class:"text-lg font-semibold"},"Conversation Trends",-1)])]),content:c(()=>[s("div",At,[b.value?(u(),x(o(w),{key:0,type:"line",data:b.value,options:P,class:"h-full"},null,8,["data"])):(u(),f("div",Tt," No data available "))])]),_:1}),d(o(h),null,{title:c(()=>[...r[15]||(r[15]=[s("span",{class:"text-lg font-semibold"},"Hourly Activity",-1)])]),content:c(()=>[s("div",Et,[A.value?(u(),x(o(w),{key:0,type:"bar",data:A.value,options:T,class:"h-full"},null,8,["data"])):(u(),f("div",Ft," No data available "))])]),_:1})]),s("div",Rt,[d(o(h),null,{title:c(()=>[...r[16]||(r[16]=[s("span",{class:"text-lg font-semibold"},"Sentiment Analysis",-1)])]),content:c(()=>[s("div",Lt,[g.value?(u(),x(o(w),{key:0,type:"doughnut",data:g.value,options:P,class:"h-full"},null,8,["data"])):(u(),f("div",Nt," No data available "))]),o(t).sentimentData?(u(),f("div",Bt,[r[17]||(r[17]=s("p",{class:"text-sm text-surface-500"},"Overall Score",-1)),s("p",Vt,p(o(t).sentimentData.overall_score),1)])):O("",!0)]),_:1}),d(o(h),null,{title:c(()=>[...r[18]||(r[18]=[s("span",{class:"text-lg font-semibold"},"Customer Satisfaction",-1)])]),content:c(()=>[s("div",It,[$.value?(u(),x(o(w),{key:0,type:"bar",data:$.value,options:T,class:"h-full"},null,8,["data"])):(u(),f("div",Ut," No data available "))]),o(t).satisfactionData?(u(),f("div",Mt,[s("div",null,[r[19]||(r[19]=s("p",{class:"text-sm text-surface-500"},"Avg Rating",-1)),s("p",Ht,p(o(t).satisfactionData.avg_rating)+"/5",1)]),s("div",null,[r[20]||(r[20]=s("p",{class:"text-sm text-surface-500"},"NPS",-1)),s("p",{class:D(["text-xl font-bold",o(t).satisfactionData.nps>=0?"text-green-500":"text-red-500"])},p(o(t).satisfactionData.nps),3)])])):O("",!0)]),_:1}),d(o(h),null,{title:c(()=>[...r[21]||(r[21]=[s("span",{class:"text-lg font-semibold"},"Platform Performance",-1)])]),content:c(()=>[o(t).platformPerformance.length?(u(),f("div",Kt,[(u(!0),f(j,null,S(o(t).platformPerformance,n=>(u(),f("div",{key:n.platform_slug,class:"flex items-center justify-between p-3 bg-surface-50 dark:bg-surface-700 rounded-lg"},[s("div",qt,[s("i",{class:D(["pi",H(n.platform_slug),"text-xl"])},null,2),s("span",zt,p(n.platform),1)]),s("div",Gt,[s("p",Yt,p(n.conversations),1),s("p",Zt,p(n.resolved)+" resolved",1)])]))),128))])):(u(),f("div",Jt," No platform data "))]),_:1})]),d(o(h),null,{title:c(()=>[...r[22]||(r[22]=[s("span",{class:"text-lg font-semibold"},"Agent Performance",-1)])]),content:c(()=>[d(o(et),{value:o(t).agentPerformance,stripedRows:"",class:"p-datatable-sm"},{empty:c(()=>[...r[23]||(r[23]=[s("div",{class:"text-center py-8 text-surface-500"}," No agent data available ",-1)])]),default:c(()=>[d(o(C),{field:"agent_name",header:"Agent",style:{"min-width":"150px"}},{body:c(({data:n})=>[s("div",Qt,[r[24]||(r[24]=s("div",{class:"w-8 h-8 rounded-full bg-surface-200 dark:bg-surface-700 flex items-center justify-center"},[s("i",{class:"pi pi-user text-sm"})],-1)),s("span",Wt,p(n.agent_name),1)])]),_:1}),d(o(C),{field:"conversations",header:"Conversations",style:{width:"150px"}},{body:c(({data:n})=>[s("span",Xt,p(n.conversations),1)]),_:1}),d(o(C),{field:"resolved",header:"Resolved",style:{width:"150px"}},{body:c(({data:n})=>[s("div",te,[s("span",ee,p(n.resolved),1),n.conversations>0?(u(),x(o(at),{key:0,value:`${Math.round(n.resolved/n.conversations*100)}%`,severity:n.resolved/n.conversations>=.8?"success":"warn"},null,8,["value","severity"])):O("",!0)])]),_:1}),d(o(C),{field:"avg_confidence",header:"Avg Confidence",style:{width:"150px"}},{body:c(({data:n})=>[d(o(st),{value:Math.round((n.avg_confidence||0)*100),showValue:!0,style:{height:"20px"}},null,8,["value"])]),_:1})]),_:1},8,["value"])]),_:1})]))]))}};export{he as default};
